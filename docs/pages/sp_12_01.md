---
# note: this file is automatically generated!
chapter_num: 12
chapter_title: 12. Stomatal Conductance
sp_id: sp_12_01
sp_id_book: '12.1'
sp_num: 1
sp_title: ''
# 
aux_program_repo_rel_paths:
- sp_12_01/brent_root.m
- sp_12_01/CiFunc.m
- sp_12_01/CiFuncOptimization.m
- sp_12_01/hybrid_root.m
- sp_12_01/latvap.m
- sp_12_01/LeafBoundaryLayer.m
- sp_12_01/LeafPhotosynthesis.m
- sp_12_01/LeafPhysiologyParams.m
- sp_12_01/LeafTranspiration.m
- sp_12_01/satvap.m
- sp_12_01/StomataEfficiency.m
- sp_12_01/StomataOptimization.m
main_program_repo_rel_path: sp_12_01/sp_12_01.m
# 
permalink: /ch12/01.html
title: Supplemental Program 12.1
# 
parent: 12. Stomatal Conductance
---

# Code

## Main program

<details>
  <summary markdown="span">
    `sp_12_01.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/sp_12_01.m)
  </summary>

```matlab
% Supplemental program 12.1

% -------------------------------------------------------------------------
% Calculate leaf gas exchange for C3 and C4 plants in relation to PAR, CO2,
% temperature, and vapor pressure deficit. For this example, leaf temperature
% is specified (not calculated).
% -------------------------------------------------------------------------

% --- Waveband indices for visible and near-infrared

params.vis = 1; params.nir = 2;

% --- Physical constants

physcon.grav = 9.80665;               % Gravitational acceleration (m/s2)
physcon.tfrz = 273.15;                % Freezing point of water (K)
physcon.mmh2o = 18.02 / 1000;         % Molecular mass of water (kg/mol)
physcon.rgas = 8.31446;               % Universal gas constant (J/K/mol)
physcon.visc0 = 13.3e-06;             % Kinematic viscosity at 0C and 1013.25 hPa (m2/s)
physcon.Dh0 = 18.9e-06;               % Molecular diffusivity (heat) at 0C and 1013.25 hPa (m2/s)
physcon.Dv0 = 21.8e-06;               % Molecular diffusivity (H2O) at 0C and 1013.25 hPa (m2/s)
physcon.Dc0 = 13.8e-06;               % Molecular diffusivity (CO2) at 0C and 1013.25 hPa (m2/s)

% --- Set leaf physiology variables

% Stomatal conductance: 0 = Medlyn model. 1 = Ball-Berry model. 2 = WUE optimization

  leaf.gstyp = 0;
% leaf.gstyp = 1;
% leaf.gstyp = 2;

% Photosynthetic pathway: 1 = C3. 0 = C4

  leaf.c3psn = 1;
% leaf.c3psn = 0;

% Photosynthesis co-limitation: 0 = no. 1 = yes

  leaf.colim = 1;
% leaf.colim = 0;

% Leaf physiological parameters

[leaf] = LeafPhysiologyParams (params, physcon, leaf);

% --- Plot type: 1 = light. 2 = CO2. 3 = temperature. 4 = vapor pressure deficit

plot_type = 1;

% --- Default conditions

co2conc = 380;                   % Atmospheric CO2 (umol/mol)
relhum = 80;                     % Air relative humidity (%)
air_temp = physcon.tfrz + 25;    % Air temperature (K)
par_sat = 2000;                  % Incident PAR (umol photon/m2/s)
leaf_temp = physcon.tfrz + 25;   % Leaf temperature (K)

% Atmospheric CO2 (umol/mol) and O2 (mmol/mol)

atmos.co2air = co2conc;
atmos.o2air = 0.209 * 1000;

% Leaf absorbed PAR (umol photon/m2 leaf/s)

atmos.par = par_sat;
flux.apar = atmos.par * (1 - leaf.rho(params.vis) - leaf.tau(params.vis));

% Leaf temperature (K) and saturation vapor pressure (Pa)

flux.tleaf = leaf_temp;
[esat_tleaf, desat_tleaf] = satvap ((flux.tleaf-physcon.tfrz));

% Air temperature (K) and vapor pressure (Pa)

atmos.tair = air_temp;
atmos.relhum = relhum;
[esat_tair, desat_tair] = satvap ((atmos.tair-physcon.tfrz));
atmos.eair = esat_tair * (atmos.relhum / 100);
vpd_tleaf = esat_tleaf - atmos.eair;

% Wind (m/s)
% u = 0.01_r8  ! Still air
% u = 0.1_r8   ! Calm - smoke rises vertically
% u = 1.0_r8   ! Light air - smoke drift indicates wind direction
% u = 2.5_r8   ! Light breeze - wind felt on skin, leaves rustle
% u = 5.0_r8   ! Gentle breeze - leaves constantly moving and light flag extended
% u = 10.0_r8  ! Moderate breeze

atmos.wind = 5;

% Atmospheric pressure (Pa) and molar density (mol/m3)

atmos.patm = 101325;
atmos.rhomol = atmos.patm / (physcon.rgas * atmos.tair);

% --- Leaf boundary layer conductances

[flux] = LeafBoundaryLayer (physcon, atmos, leaf, flux);

% ---  Light response at standard CO2, leaf temperature, and VPD

if (plot_type == 1)

   p = 0;
   for i = 0: 10: 2000

      % Set value for PAR

      atmos.par = i;
      flux.apar = atmos.par * (1 - leaf.rho(params.vis) - leaf.tau(params.vis));

      % Calculate photosynthesis and stomatal conductance

      if (leaf.gstyp <= 1)
         [flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
      elseif (leaf.gstyp == 2)
         [flux] = StomataOptimization (physcon, atmos, leaf, flux);
      end

      % Save data for output

      p = p + 1;
      x1(p) = atmos.par;
      x2(p) = flux.tleaf - physcon.tfrz;
      x3(p) = atmos.co2air;
      x4(p) = (esat_tleaf - atmos.eair) * 0.001;
      x5(p) = flux.hs;
      x6(p) = flux.ci / atmos.co2air;
      x7(p) = flux.ac - flux.rd;
      x8(p) = flux.aj - flux.rd;
      x9(p) = flux.ap - flux.rd;
      x10(p) = flux.an;
      x11(p) = flux.gs;
      x12(p) = flux.gbh;

   end

   % Plot data

   plot(x1,x11)
   xlabel('PAR (\mumol m^{-2} s^{-1})')
   ylabel('Stomatal conductance (mol H_2O m^{-2} s^{-1})')

   % Output data and then clear variables from memory

   A = [x1; x2; x3; x4; x5; x6; x7; x8; x9; x10; x11; x12];
   filename = 'light_response.txt';
   fileID = fopen(filename,'w');
   fprintf(fileID,'%6.1f %6.1f %6.1f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f\n', A);
   fclose(fileID);
   clear x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 A;

   % Reset to default value

   atmos.par = par_sat;
   flux.apar = atmos.par * (1 - leaf.rho(params.vis) - leaf.tau(params.vis));

end

% --- CO2 response at saturated light and standard leaf temperature and VPD

if (plot_type == 2)

   p = 0;
   for i = 100: 10: 1000

      % Set value for CO2

      atmos.co2air = i;

      % Calculate photosynthesis and stomatal conductance

      if (leaf.gstyp <= 1)
         [flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
      elseif (leaf.gstyp == 2)
         [flux] = StomataOptimization (physcon, atmos, leaf, flux);
      end

      % Save data for output

      p = p + 1;
      x1(p) = atmos.par;
      x2(p) = flux.tleaf - physcon.tfrz;
      x3(p) = atmos.co2air;
      x4(p) = (esat_tleaf - atmos.eair) * 0.001;
      x5(p) = flux.hs;
      x6(p) = flux.ci / atmos.co2air;
      x7(p) = flux.ac - flux.rd;
      x8(p) = flux.aj - flux.rd;
      x9(p) = flux.ap - flux.rd;
      x10(p) = flux.an;
      x11(p) = flux.gs;
      x12(p) = flux.gbh;

   end

   % Plot data

   plot(x3,x11)
   xlabel('c_a (\mumol mol^{-1})')
   ylabel('Stomatal conductance (mol H_2O m^{-2} s^{-1})')

   % Output data and then clear variables from memory

   A = [x1; x2; x3; x4; x5; x6; x7; x8; x9; x10; x11; x12];
   filename = 'co2_response.txt';
   fileID = fopen(filename,'w');
   fprintf(fileID,'%6.1f %6.1f %6.1f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f\n', A);
   fclose(fileID);
   clear x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 A;

   % Reset to default value

   atmos.co2air = co2conc;

end

% --- Temperature response at saturated light and standard CO2 and constant RH or VPD

if (plot_type == 3)

   p = 0;
   for i = 10: 1: 35

      % Set value for leaf temperature and adjust vapor pressure of air so that
      % RH or VPD is constant

      flux.tleaf = physcon.tfrz + i;
      [esat_current, desat_current] = satvap ((flux.tleaf-physcon.tfrz));

      if (leaf.gstyp == 1)
         % Adjust vapor pressure of air so that RH is constant
         atmos.eair = (relhum  / 100) * esat_current;
      else
         % Adjust vapor pressure of air so that VPD is constant
         atmos.eair = esat_current - vpd_tleaf;
      end

      % Change iota based on temperature

      %  if (leaf.gstyp == 2)
      %     ft = @(tl, ha) exp(ha/(physcon.rgas*(physcon.tfrz+25)) * (1-(physcon.tfrz+25)/tl));
      %     cp_tleaf = leaf.cp25 * ft(flux.tleaf, leaf.cpha);
      %     leaf.iota = (leaf.iota25 / 1022) * 3 * cp_tleaf / (1.6 * 2.8 * 2.8) * 100;
      %  end

      % Calculate photosynthesis and stomatal conductance

      if (leaf.gstyp <= 1)
         [flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
      elseif (leaf.gstyp == 2)
         [flux] = StomataOptimization (physcon, atmos, leaf, flux);
      end

      % Save data for output

      p = p + 1;
      x1(p) = atmos.par;
      x2(p) = flux.tleaf - physcon.tfrz;
      x3(p) = atmos.co2air;
      x4(p) = (esat_current - atmos.eair) * 0.001;
      x5(p) = flux.hs;
      x6(p) = flux.ci / atmos.co2air;
      x7(p) = flux.ac - flux.rd;
      x8(p) = flux.aj - flux.rd;
      x9(p) = flux.ap - flux.rd;
      x10(p) = flux.an;
      x11(p) = flux.gs;
      x12(p) = flux.gbh;

   end

   % Plot data

   plot(x2,x11)
   xlabel('Temperature (^{o}C)')
   ylabel('Stomatal conductance (mol H_2O m^{-2} s^{-1})')

   % Output data and then clear variables from memory

   A = [x1; x2; x3; x4; x5; x6; x7; x8; x9; x10; x11; x12];
   filename = 'temperature_response.txt';
   fileID = fopen(filename,'w');
   fprintf(fileID,'%6.1f %6.1f %6.1f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f\n', A);
   fclose(fileID);
   clear x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 A;

   % Reset to default value

   flux.tleaf = leaf_temp;
   atmos.eair = (relhum  / 100) * esat_tleaf;
   if (leaf.gstyp == 2)
      leaf.iota = leaf.iota25;
   end

end

% --- Vapor pressure response at saturated light and standard CO2 and temperature

if (plot_type == 4)

   p = 0;
   for i = 10: 2: 100

      % Set value for vapor pressure of air

      [esat, desat] = satvap ((atmos.tair-physcon.tfrz));
      atmos.relhum = i;
      atmos.eair = esat * (atmos.relhum / 100);

      % Calculate photosynthesis and stomatal conductance

      if (leaf.gstyp <= 1)
         [flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
      elseif (leaf.gstyp == 2)
         [flux] = StomataOptimization (physcon, atmos, leaf, flux);
      end

      % Save data for output

      p = p + 1;
      x1(p) = atmos.par;
      x2(p) = flux.tleaf - physcon.tfrz;
      x3(p) = atmos.co2air;
      x4(p) = (esat_tleaf - atmos.eair) * 0.001;
      x5(p) = flux.hs;
      x6(p) = flux.ci / atmos.co2air;
      x7(p) = flux.ac - flux.rd;
      x8(p) = flux.aj - flux.rd;
      x9(p) = flux.ap - flux.rd;
      x10(p) = flux.an;
      x11(p) = flux.gs;
      x12(p) = flux.gbh;

   end

   % Plot data

   plot(x4,x11)
   xlabel('VPD (kPa)')
   ylabel('Stomatal conductance (mol H_2O m^{-2} s^{-1})')

   % Output data and then clear variables from memory

   A = [x1; x2; x3; x4; x5; x6; x7; x8; x9; x10; x11; x12];
   filename = 'vpd_response.txt';
   fileID = fopen(filename,'w');
   fprintf(fileID,'%6.1f %6.1f %6.1f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f %9.4f\n', A);
   fclose(fileID);
   clear x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 A;

   % Reset to default value

   atmos.relhum = relhum;
   [esat, desat] = satvap ((atmos.tair-physcon.tfrz));
   atmos.eair = esat * atmos.relhum / 100;

end
```
{: #main-program-code}

</details>

## Aux. programs

<details>
  <summary markdown="span">
    `brent_root.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/brent_root.m)
  </summary>

```matlab
function [flux, root] = brent_root (func, physcon, atmos, leaf, flux, xa, xb, tol)

% Use Brent's method to find the root of a function, which is known to exist between
% xa and xb. The root is updated until its accuracy is tol. func is the name of the
% function to solve. The variable root is returned as the root of the function. The
% function being evaluated has the definition statement: 
%
% function [flux, fx] = func (physcon, atmos, leaf, flux, x)
%
% The function func is exaluated at x and the returned value is fx. It uses variables
% in the physcon, atmos, leaf, and flux structures. These are passed in as
% input arguments. It also calculates values for variables in the flux structure
% so this must be returned in the function call as an output argument. The matlab
% function feval evaluates func.

% --- Evaluate func at xa and xb and make sure the root is bracketed

a = xa;
b = xb;
[flux, fa] = feval(func, physcon, atmos, leaf, flux, a);
[flux, fb] = feval(func, physcon, atmos, leaf, flux, b);

if ((fa > 0 & fb > 0) | (fa < 0 & fb < 0))
   error('brent_root error: root must be bracketed')
end

% --- Initialize iteration

itmax = 50;      % Maximum number of iterations
eps1 = 1e-08;    % Relative error tolerance

c = b;
fc = fb;

% --- Iterative root calculation

for iter = 1:itmax
   if ((fb > 0 & fc > 0) | (fb < 0 & fc < 0))
      c = a;
      fc = fa;
      d = b - a;
      e = d;
   end
   if (abs(fc) < abs(fb))
      a = b;
      b = c;
      c = a;
      fa = fb;
      fb = fc;
      fc = fa;
   end
   tol1 = 2 * eps1 * abs(b) + 0.5 * tol;
   xm = 0.5 * (c - b);

   % Check to end iteration

   if (abs(xm) <= tol1 | fb == 0)
      break
   end

   if (abs(e) >= tol1 & abs(fa) > abs(fb))
      s = fb / fa;
      if (a == c)
         p = 2 * xm * s;
         q = 1 - s;
      else
         q = fa / fc;
         r = fb / fc;
         p = s * (2 * xm * q * (q - r) - (b - a) * (r - 1));
         q = (q - 1) * (r - 1) * (s - 1);
      end
      if (p > 0)
         q = -q;
      end
      p = abs(p);
      if (2*p < min(3*xm*q-abs(tol1*q), abs(e*q)))
         e = d;
         d = p / q;
      else
         d = xm;
         e = d;
      end
   else
      d = xm;
      e = d;
   end
   a = b;
   fa = fb;
   if (abs(d) > tol1)
      b = b + d;
   else
      if (xm >= 0)
         b = b + abs(tol1);
      else
         b = b - abs(tol1);
      end
   end
   [flux, fb] = feval(func, physcon, atmos, leaf, flux, b);

   % Check to end iteration

   if (fb == 0)
      break
   end

   % Check to see if failed to converge

   if (iter == itmax)
      error('brent_root error: Maximum number of interations exceeded')
   end

end
root = b;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `CiFunc.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/CiFunc.m)
  </summary>

```matlab
function [flux, ci_dif] = CiFunc (physcon, atmos, leaf, flux, ci_val)

% Calculate leaf photosynthesis and stomatal conductance for a specified Ci
% (ci_val). Then calculate a new Ci from the diffusion equation. This function
% returns a value ci_dif = 0 when Ci has converged to the value that satisfies
% the metabolic, stomatal constraint, and diffusion equations.

% ------------------------------------------------------
% Input
%   physcon.tfrz        ! Freezing point of water (K)
%   atmos.o2air         ! Atmospheric O2 (mmol/mol)
%   atmos.co2air        ! Atmospheric CO2 (umol/mol)
%   atmos.eair          ! Vapor pressure of air (Pa)
%   leaf.c3psn          ! Photosynthetic pathway: 1 = C3. 0 = C4 plant
%   leaf.gstyp          ! Stomatal conductance: 0 = Medlyn. 1 = Ball-Berry. 2 = WUE optimization
%   leaf.colim          ! Photosynthesis co-limitation: 0 = no. 1 = yes
%   leaf.colim_c3       ! Empirical curvature parameter for C3 co-limitation
%   leaf.colim_c4a      ! Empirical curvature parameter for C4 co-limitation
%   leaf.colim_c4b      ! Empirical curvature parameter for C4 co-limitation
%   leaf.qe_c4          ! C4: Quantum yield (mol CO2 / mol photons)
%   leaf.g0             ! Ball-Berry minimum leaf conductance (mol H2O/m2/s)
%   leaf.g1             ! Ball-Berry slope of conductance-photosynthesis relationship
%   flux.vcmax          ! Maximum carboxylation rate (umol/m2/s)
%   flux.cp             ! CO2 compensation point (umol/mol)
%   flux.kc             ! Michaelis-Menten constant for CO2 (umol/mol)
%   flux.ko             ! Michaelis-Menten constant for O2 (mmol/mol)
%   flux.je             ! Electron transport rate (umol/m2/s)
%   flux.kp_c4          ! C4: Initial slope of CO2 response curve (mol/m2/s)
%   flux.rd             ! Leaf respiration rate (umol CO2/m2 leaf/s)
%   flux.gbv            ! Leaf boundary layer conductance, H2O (mol H2O/m2 leaf/s)
%   flux.gbc            ! Leaf boundary layer conductance, CO2 (mol CO2/m2 leaf/s)
%   flux.apar           ! Leaf absorbed PAR (umol photon/m2 leaf/s)
%   flux.tleaf          ! Leaf temperature (K)
%   ci_val              ! Input value for Ci (umol/mol)
%
% Output
%   flux.ac             ! Leaf Rubisco-limited gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.aj             ! Leaf RuBP regeneration-limited gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.ap             ! Leaf product-limited (C3) or CO2-limited (C4) gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.ag             ! Leaf gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.an             ! Leaf net photosynthesis (umol CO2/m2 leaf/s)
%   flux.cs             ! Leaf surface CO2 (umol/mol)
%   flux.gs             ! Leaf stomatal conductance (mol H2O/m2 leaf/s)
%   ci_dif              ! Difference in Ci
% ------------------------------------------------------

% --- Metabolic (demand-based) photosynthetic rate

if (leaf.c3psn == 1)

   % C3: Rubisco-limited photosynthesis
   flux.ac = flux.vcmax * max(ci_val - flux.cp, 0) / (ci_val + flux.kc * (1 + atmos.o2air / flux.ko));
 
   % C3: RuBP regeneration-limited photosynthesis
   flux.aj = flux.je * max(ci_val - flux.cp, 0) / (4 * ci_val + 8 * flux.cp);

   % C3: Product-limited photosynthesis (do not use)
   flux.ap = 0;

else

   % C4: Rubisco-limited photosynthesis
   flux.ac = flux.vcmax;
 
   % C4: RuBP regeneration-limited photosynthesis
   flux.aj = leaf.qe_c4 * flux.apar;

   % C4: PEP carboxylase-limited (CO2-limited)
   flux.ap = flux.kp_c4 * max(ci_val, 0);

end

% --- Net photosynthesis as the minimum or co-limited rate

if (leaf.colim == 1) % Use co-limitation

   % First co-limit Ac and Aj. Ai is the intermediate co-limited photosynthesis
   % rate found by solving the polynomial: aquad*Ai^2 + bquad*Ai + cquad = 0 for Ai.
   % Correct solution is the smallest of the two roots.

   if (leaf.c3psn == 1)
      aquad = leaf.colim_c3;
   else
      aquad = leaf.colim_c4a;
   end
   bquad = -(flux.ac + flux.aj);
   cquad = flux.ac * flux.aj;
   pcoeff = [aquad bquad cquad];
   proots = roots(pcoeff);
   ai = min(proots(1), proots(2));

   % Now co-limit again using Ap, but only for C4 plants. Solve the polynomial:
   % aquad*Ag^2 + bquad*Ag + cquad = 0 for Ag. Correct solution is the smallest
   % of the two roots. Ignore the product-limited rate For C3 plants.

   if (leaf.c3psn == 0)
      aquad = leaf.colim_c4b;
      bquad = -(ai + flux.ap);
      cquad = ai * flux.ap;
      pcoeff = [aquad bquad cquad];
      proots = roots(pcoeff);
      flux.ag = min(proots(1), proots(2));
   else
      flux.ag = ai;
   end

elseif (leaf.colim == 0) % No co-limitation

   if (leaf.c3psn == 1)
      flux.ag = min(flux.ac, flux.aj); % C3
   else
      flux.ag = min(flux.ac, flux.aj, flux.ap); % C4
   end

end

% Prevent photosynthesis from ever being negative

flux.ac = max(flux.ac, 0);
flux.aj = max(flux.aj, 0);
flux.ap = max(flux.ap, 0);
flux.ag = max(flux.ag, 0);

% Net CO2 uptake

flux.an = flux.ag - flux.rd;

% --- CO2 at leaf surface

flux.cs = atmos.co2air - flux.an / flux.gbc;
flux.cs = max(flux.cs, 1);

% --- Stomatal constraint function

% Saturation vapor pressure at leaf temperature

[esat, desat] = satvap ((flux.tleaf-physcon.tfrz));

% Ball-Berry stomatal conductance is a quadratic equation
% for gs given An: aquad*gs^2 + bquad*gs + cquad = 0. Correct
% solution is the larger of the two roots. This solution is
% valid for An >= 0. With An <= 0, gs = g0.

if (leaf.gstyp == 1)
   term = flux.an / flux.cs;
   if (flux.an > 0)
      aquad = 1;
      bquad = flux.gbv - leaf.g0 - leaf.g1 * term;
      cquad = -flux.gbv * (leaf.g0 + leaf.g1 * term * atmos.eair / esat);
      pcoeff = [aquad bquad cquad];
      proots = roots(pcoeff);
      flux.gs = max(proots(1), proots(2));
   else
      flux.gs = leaf.g0;
   end
end

% Quadratic equation for Medlyn stomatal conductance

if (leaf.gstyp == 0)
   vpd = max((esat - atmos.eair), 50) * 0.001;
   term = 1.6 * flux.an / flux.cs;
   if (flux.an > 0)
      aquad = 1;
      bquad = -(2 * (leaf.g0 + term) + (leaf.g1 * term)^2 / (flux.gbv * vpd));
      cquad = leaf.g0 * leaf.g0 + (2 * leaf.g0 + term * (1 - leaf.g1 * leaf.g1 / vpd)) * term;
      pcoeff = [aquad bquad cquad];
      proots = roots(pcoeff);
      flux.gs = max(proots(1), proots(2));
   else
      flux.gs = leaf.g0;
   end
end

% --- Diffusion (supply-based) photosynthetic rate

% Leaf CO2 conductance (mol CO2/m2/s)

gleaf = 1 / (1 / flux.gbc + 1.6 / flux.gs);

% Calculate Ci from the diffusion rate

cinew = atmos.co2air - flux.an / gleaf;

% --- Return the difference between the current Ci and the new Ci

if (flux.an >= 0)
   ci_dif = cinew - ci_val;
else
   ci_dif = 0;
end
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `CiFuncOptimization.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/CiFuncOptimization.m)
  </summary>

```matlab
function [flux] = CiFuncOptimization (atmos, leaf, flux)

% Calculate leaf photosynthesis for a specified stomatal conductance.
% Then calculate Ci from the diffusion equation. 
%
% This routine uses a quadratic equation to solve for net photosynthesis (An).
% A general equation for C3 photosynthesis is:
%
%      a*(Ci - Cp)
% An = ----------- - Rd
%       e*Ci + d
%
% where:
%
% An = Net leaf photosynthesis (umol CO2/m2/s)
% Rd = Leaf respiration (umol CO2/m2/s)
% Ci = Intercellular CO2 concentration (umol/mol)
% Cp = CO2 compensation point (umol/mol)
% 
% Rubisco-limited photosynthesis (Ac)
% a  = Vcmax
% e  = 1
% d  = Kc*(1 + Oi/Ko)
%
% RuBP regeneration-limited photosynthesis (Aj)
% a = J
% e = 4
% d = 8*Cp
%
% where:
%
% Vcmax = Maximum carboxylation rate (umol/m2/s)
% Kc    = Michaelis-Menten constant for CO2 (umol/mol)
% Ko    = Michaelis-Menten constant for O2 (mmol/mol)
% Oi    = Intercellular O2 concentration (mmol/mol)
% J     = Electron transport rate (umol/m2/s)
%
% Ci is calculated from the diffusion equation:
%
%                   1.4   1.6
% An = (Ca - Ci) / (--- + ---)
%                   gb    gs
%
%            1.4   1.6
% Ci = Ca - (--- + ---)*An
%            gb    gs
%
% where:
% 
% Ca  = Atmospheric CO2 concentration (umol/mol)
% gb  = Leaf boundary layer conductance (mol H2O/m2/s)
% gs  = Leaf stomatal conductance (mol H2O/m2/s)
% 1.4 = Corrects gb for the diffusivity of CO2 compared with H2O
% 1.6 = Corrects gs for the diffusivity of CO2 compared with H2O
%
% The resulting quadratic equation is: a*An^2 + b*An + c = 0, which
% is solved for An. Correct solution is the smaller of the two roots.
%
% A similar approach is used for C4 photosynthesis.

% ------------------------------------------------------
% Input
%   atmos.o2air         ! Atmospheric O2 (mmol/mol)
%   atmos.co2air        ! Atmospheric CO2 (umol/mol)
%   leaf.c3psn          ! Photosynthetic pathway: 1 = C3. 0 = C4 plant
%   leaf.colim          ! Photosynthesis co-limitation: 0 = no. 1 = yes
%   leaf.colim_c3       ! Empirical curvature parameter for C3 co-limitation
%   leaf.colim_c4a      ! Empirical curvature parameter for C4 co-limitation
%   leaf.colim_c4b      ! Empirical curvature parameter for C4 co-limitation
%   leaf.qe_c4          ! C4: Quantum yield (mol CO2 / mol photons)
%   flux.vcmax          ! Maximum carboxylation rate (umol/m2/s)
%   flux.cp             ! CO2 compensation point (umol/mol)
%   flux.kc             ! Michaelis-Menten constant for CO2 (umol/mol)
%   flux.ko             ! Michaelis-Menten constant for O2 (mmol/mol)
%   flux.je             ! Electron transport rate (umol/m2/s)
%   flux.kp_c4          ! C4: Initial slope of CO2 response curve (mol/m2/s)
%   flux.gs             ! Leaf stomatal conductance (mol H2O/m2 leaf/s)
%   flux.gbc            ! Leaf boundary layer conductance, CO2 (mol CO2/m2 leaf/s)
%   flux.apar           ! Leaf absorbed PAR (umol photon/m2 leaf/s)
%   flux.rd             ! Leaf respiration rate (umol CO2/m2 leaf/s)
%
% Output
%   flux.ac             ! Leaf Rubisco-limited gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.aj             ! Leaf RuBP regeneration-limited gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.ap             ! Leaf product-limited (C3) or CO2-limited (C4) gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.ag             ! Leaf gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.an             ! Leaf net photosynthesis (umol CO2/m2 leaf/s)
%   flux.cs             ! Leaf surface CO2 (umol/mol)
%   flux.ci             ! Leaf intercellular CO2 (umol/mol)
% ------------------------------------------------------

% --- Leaf conductance
% gbc has units mol CO2/m2/s
% gs has units mol H2O/m2/s
% gleaf has units mol CO2/m2/s

gleaf = 1 / (1 / flux.gbc + 1.6 / flux.gs);

% --- Gross assimilation rates

if (leaf.c3psn == 1)

   % C3: Rubisco-limited photosynthesis

   a0 = flux.vcmax;
   e0 = 1;
   d0 = flux.kc * (1 + atmos.o2air / flux.ko);

   aquad = e0 / gleaf;
   bquad = -(e0 * atmos.co2air + d0) - (a0 - e0 * flux.rd) / gleaf;
   cquad = a0 * (atmos.co2air - flux.cp) - flux.rd * (e0 * atmos.co2air + d0);

   pcoeff = [aquad bquad cquad];
   proots = roots(pcoeff);
   flux.ac = min(proots(1), proots(2)) + flux.rd;
 
   % C3: RuBP regeneration-limited photosynthesis

   a0 = flux.je;
   e0 = 4;
   d0 = 8 * flux.cp;

   aquad = e0 / gleaf;
   bquad = -(e0 * atmos.co2air + d0) - (a0 - e0 * flux.rd) / gleaf;
   cquad = a0 * (atmos.co2air - flux.cp) - flux.rd * (e0 * atmos.co2air + d0);

   pcoeff = [aquad bquad cquad];
   proots = roots(pcoeff);
   flux.aj = min(proots(1), proots(2)) + flux.rd;

   % C3: Product-limited photosynthesis

   flux.ap = 0;

else

   % C4: Rubisco-limited photosynthesis

   flux.ac = flux.vcmax;
 
   % C4: RuBP-limited photosynthesis

   flux.aj = leaf.qe_c4 * flux.apar;

   % C4: PEP carboxylase-limited (CO2-limited)

   flux.ap = flux.kp_c4 * (atmos.co2air * gleaf + flux.rd) / (gleaf + flux.kp_c4);

end

% --- Net assimilation as the minimum or co-limited rate

if (leaf.colim == 1) % Use co-limitation

   % First co-limit Ac and Aj. Ai is the intermediate co-limited photosynthesis
   % rate found by solving the polynomial: aquad*Ai^2 + bquad*Ai + cquad = 0 for Ai.
   % Correct solution is the smallest of the two roots.

   if (leaf.c3psn == 1)
      aquad = leaf.colim_c3;
   else
      aquad = leaf.colim_c4a;
   end
   bquad = -(flux.ac + flux.aj);
   cquad = flux.ac * flux.aj;
   pcoeff = [aquad bquad cquad];
   proots = roots(pcoeff);
   ai = min(proots(1), proots(2));

   % Now co-limit again using Ap, but only for C4 plants. Solve the polynomial:
   % aquad*Ag^2 + bquad*Ag + cquad = 0 for Ag. Correct solution is the smallest
   % of the two roots. Ignore the product-limited rate For C3 plants.

   if (leaf.c3psn == 0)
      aquad = leaf.colim_c4b;
      bquad = -(ai + flux.ap);
      cquad = ai * flux.ap;
      pcoeff = [aquad bquad cquad];
      proots = roots(pcoeff);
      flux.ag = min(proots(1), proots(2));
   else
      flux.ag = ai;
   end

elseif (leaf.colim == 0) % No co-limitation

   if (leaf.c3psn == 1)
      flux.ag = min(flux.ac, flux.aj); % C3
   else
      flux.ag = min(flux.ac, flux.aj, flux.ap); % C4
   end

end

% Prevent photosynthesis from ever being negative

flux.ac = max(flux.ac, 0);
flux.aj = max(flux.aj, 0);
flux.ap = max(flux.ap, 0);
flux.ag = max(flux.ag, 0);

% Net CO2 uptake

flux.an = flux.ag - flux.rd;

% --- CO2 at leaf surface

flux.cs = atmos.co2air - flux.an / flux.gbc;
flux.cs = max(flux.cs, 1);

% --- Intercelluar CO2

flux.ci = atmos.co2air - flux.an / gleaf;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `hybrid_root.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/hybrid_root.m)
  </summary>

```matlab
function [flux, root] = hybrid_root (func, physcon, atmos, leaf, flux, xa, xb, tol)

% Solve for the root of a function using the secant and Brent's methods given
% initial estimates xa and xb. The root is updated until its accuracy is tol. 
% func is the name of the function to solve. The variable root is returned as
% the root of the function. The function being evaluated has the definition statement: 
%
% function [flux, fx] = func (physcon, atmos, leaf, flux, x)
%
% The function func is exaluated at x and the returned value is fx. It uses variables
% in the physcon, atmos, leaf, and flux structures. These are passed in as
% input arguments. It also calculates values for variables in the flux structure
% so this must be returned in the function call as an output argument. The matlab
% function feval evaluates func.

% --- Evaluate func at xa and see if this is the root

x0 = xa;
[flux, f0] = feval(func, physcon, atmos, leaf, flux, x0);
if (f0 == 0)
   root = x0;
   return
end

% --- Evaluate func at xb and see if this is the root

x1 = xb;
[flux, f1] = feval(func, physcon, atmos, leaf, flux, x1);
if (f1 == 0)
   root = x1;
   return
end

% --- Order initial root estimates correctly

if (f1 < f0)
   minx = x1;
   minf = f1;
else
   minx = x0;
   minf = f0;
end

% --- Iterative root calculation. Use the secant method, with Brent's method as a backup

itmax = 40;
for iter = 1:itmax
   dx = -f1 * (x1 - x0) / (f1 - f0);
   x = x1 + dx;

   % Check if x is the root. If so, exit the iteration

   if (abs(dx) < tol)
      x0 = x;
      break
   end

   % Evaluate the function at x

   x0 = x1;
   f0 = f1;
   x1 = x;
   [flux, f1] = feval(func, physcon, atmos, leaf, flux, x1);
   if (f1 < minf)
      minx = x1;
      minf = f1;
   end

   % If a root zone is found, use Brent's method for a robust backup strategy
   % and exit the iteration

   if (f1 * f0 < 0)
      [flux, x] = brent_root (func, physcon, atmos, leaf, flux, x0, x1, tol);
      x0 = x;
      break
   end

   % In case of failing to converge within itmax iterations stop at the minimum function

   if (iter == itmax)
      [flux, f1] = feval(func, physcon, atmos, leaf, flux, minx);
      x0 = minx;
   end

end

root = x0;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `latvap.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/latvap.m)
  </summary>

```matlab
function [val] = latvap (tc, mmh2o)

% Latent heat of vaporization (J/mol) at temperature tc (degC)

val = 2501.6 - 2.3773 * tc; % Latent heat of vaporization (J/g)
val = val * 1000;           % Convert from J/g to J/kg
val = val * mmh2o;          % Convert from J/kg to J/mol
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `LeafBoundaryLayer.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/LeafBoundaryLayer.m)
  </summary>

```matlab
function [flux] = LeafBoundaryLayer (physcon, atmos, leaf, flux)

% Leaf boundary layer conductances

% -------------------------------------------------------------------------
% Input
%   physcon.grav      ! Gravitational acceleration (m/s2)
%   physcon.tfrz      ! Freezing point of water (K)
%   physcon.visc0     ! Kinematic viscosity at 0C and 1013.25 hPa (m2/s)
%   physcon.Dh0       ! Molecular diffusivity (heat) at 0C and 1013.25 hPa (m2/s)
%   physcon.Dv0       ! Molecular diffusivity (H2O) at 0C and 1013.25 hPa (m2/s)
%   physcon.Dc0       ! Molecular diffusivity (CO2) at 0C and 1013.25 hPa (m2/s)
%   atmos.patm        ! Atmospheric pressure (Pa)
%   atmos.rhomol      ! Molar density mol/m3)
%   atmos.wind        ! Wind speed (m/s)
%   atmos.tair        ! Air temperature (K)
%   leaf.dleaf        ! Leaf dimension (m)
%   flux.tleaf        ! Leaf temperature (K)
%
% Output
%   flux.gbh          ! Leaf boundary layer conductance, heat (mol/m2 leaf/s)
%   flux.gbv          ! Leaf boundary layer conductance, H2O (mol H2O/m2 leaf/s)
%   flux.gbc          ! Leaf boundary layer conductance, CO2 (mol CO2/m2 leaf/s)
% -------------------------------------------------------------------------

% --- Adjust diffusivity for temperature and pressure

fac = 101325 / atmos.patm * (atmos.tair / physcon.tfrz)^1.81;

visc = physcon.visc0 * fac; % Kinematic viscosity (m2/s)
Dh = physcon.Dh0 * fac;     % Molecular diffusivity, heat (m2/s)
Dv = physcon.Dv0 * fac;     % Molecular diffusivity, H2O (m2/s)
Dc = physcon.Dc0 * fac;     % Molecular diffusivity, CO2 (m2/s)

% --- Dimensionless numbers

Re = atmos.wind * leaf.dleaf / visc; % Reynolds number
Pr = visc / Dh;                      % Prandtl number
Scv = visc / Dv;                     % Schmidt number for H2O
Scc = visc / Dc;                     % Schmidt number for CO2

% Grashof number

Gr = physcon.grav * leaf.dleaf^3 * max(flux.tleaf-atmos.tair, 0) / (atmos.tair * visc * visc);

% --- Empirical correction factor for Nu and Sh

b1 = 1.5;

% --- Nusselt number (Nu) and Sherwood numbers (H2O: Shv, CO2: Shc)

% Forced convection - laminar flow

Nu_lam  = b1 * 0.66 *  Pr^0.33 * Re^0.5;     % Nusselt number
Shv_lam = b1 * 0.66 * Scv^0.33 * Re^0.5;     % Sherwood number, H2O
Shc_lam = b1 * 0.66 * Scc^0.33 * Re^0.5;     % Sherwood number, CO2

% Forced convection - turbulent flow

Nu_turb  = b1 * 0.036 *  Pr^0.33 * Re^0.8;   % Nusselt number
Shv_turb = b1 * 0.036 * Scv^0.33 * Re^0.8;   % Sherwood number, H2O
Shc_turb = b1 * 0.036 * Scc^0.33 * Re^0.8;   % Sherwood number, CO2

% Choose correct flow regime for forced convection

Nu_forced = max(Nu_lam, Nu_turb);
Shv_forced = max(Shv_lam, Shv_turb);
Shc_forced = max(Shc_lam, Shc_turb);

% Free convection

Nu_free  = 0.54 *  Pr^0.25 * Gr^0.25;        % Nusselt number
Shv_free = 0.54 * Scv^0.25 * Gr^0.25;        % Sherwood number, H2O
Shc_free = 0.54 * Scc^0.25 * Gr^0.25;        % Sherwood number, CO2

% Both forced and free convection regimes occur together

Nu = Nu_forced + Nu_free;
Shv = Shv_forced + Shv_free;
Shc = Shc_forced + Shc_free;

% --- Boundary layer conductances (m/s)

flux.gbh = Dh *  Nu / leaf.dleaf;
flux.gbv = Dv * Shv / leaf.dleaf;
flux.gbc = Dc * Shc / leaf.dleaf;

% --- Convert conductance (m/s) to (mol/m2/s)

flux.gbh = flux.gbh * atmos.rhomol;
flux.gbv = flux.gbv * atmos.rhomol;
flux.gbc = flux.gbc * atmos.rhomol;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `LeafPhotosynthesis.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/LeafPhotosynthesis.m)
  </summary>

```matlab
function [flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux)

% Calculate leaf photosynthesis using one of two methods:
% (1) Calculate leaf photosynthesis and stomatal conductance
% by solving for the value of Ci that satisfies the
% metabolic, stomatal constraint, and diffusion equations.
% This is used with the Ball-Berry style stomatal models.
% (2) Calculate leaf photosynthesis for a specified stomatal
% conductance. Then calculate Ci from the diffusion equation.
% This is used with the WUE stomatal optimization.

% ------------------------------------------------------
% Input
%   physcon.tfrz        ! Freezing point of water (K)
%   physcon.rgas        ! Universal gas constant (J/K/mol)
%   atmos.co2air        ! Atmospheric CO2 (umol/mol)
%   atmos.eair          ! Vapor pressure of air (Pa)
%   leaf.gstyp          ! Stomatal conductance: 0 = Medlyn. 1 = Ball-Berry. 2 = WUE optimization
%   leaf.c3psn          ! Photosynthetic pathway: 1 = C3. 0 = C4 plant
%   leaf.vcmax25        ! Maximum carboxylation rate at 25C (umol/m2/s)
%   leaf.jmax25         ! Maximum electron transport rate at 25C (umol/m2/s)
%   leaf.rd25           ! Leaf respiration rate at 25C (umol CO2/m2/s)
%   leaf.kc25           ! Michaelis-Menten constant for CO2 at 25C (umol/mol)
%   leaf.ko25           ! Michaelis-Menten constant for O2 at 25C (mmol/mol)
%   leaf.cp25           ! CO2 compensation point at 25C (umol/mol)
%   leaf.kcha           ! Activation energy for Kc (J/mol)
%   leaf.koha           ! Activation energy for Ko (J/mol)
%   leaf.cpha           ! Activation energy for Cp (J/mol)
%   leaf.vcmaxha        ! Activation energy for Vcmax (J/mol)
%   leaf.jmaxha         ! Activation energy for Jmax (J/mol)
%   leaf.rdha           ! Activation energy for Rd (J/mol)
%   leaf.vcmaxhd        ! Deactivation energy for Vcmax (J/mol)
%   leaf.jmaxhd         ! Deactivation energy for Jmax (J/mol)
%   leaf.rdhd           ! Deactivation energy for Rd (J/mol)
%   leaf.vcmaxse        ! Entropy term for Vcmax (J/mol/K)
%   leaf.jmaxse         ! Entropy term for Jmax (J/mol/K)
%   leaf.rdse           ! Entropy term for Rd (J/mol/K)
%   leaf.vcmaxc         ! Vcmax scaling factor for high temperature inhibition (25 C = 1.0)
%   leaf.jmaxc          ! Jmax scaling factor for high temperature inhibition (25 C = 1.0)
%   leaf.rdc            ! Rd scaling factor for high temperature inhibition (25 C = 1.0)
%   leaf.phi_psii       ! Quantum yield of PS II
%   leaf.theta_j        ! Empirical curvature parameter for electron transport rate
%   leaf.kp25_c4        ! C4: Initial slope of CO2 response curve at 25C (mol/m2/s)
%   leaf.g0             ! Ball-Berry minimum leaf conductance (mol H2O/m2/s)
%   leaf.g1             ! Ball-Berry slope of conductance-photosynthesis relationship
%   flux.gbv            ! Leaf boundary layer conductance, H2O (mol H2O/m2 leaf/s)
%   flux.gbc            ! Leaf boundary layer conductance, CO2 (mol CO2/m2 leaf/s)
%   flux.apar           ! Leaf absorbed PAR (umol photon/m2 leaf/s)
%   flux.tleaf          ! Leaf temperature (K)
%
% Input or output (depending on method)
%   flux.gs             ! Leaf stomatal conductance (mol H2O/m2 leaf/s)
%
% Output
%   flux.vcmax          ! Maximum carboxylation rate (umol/m2/s)
%   flux.jmax           ! Maximum electron transport rate (umol/m2/s)
%   flux.cp             ! CO2 compensation point (umol/mol)
%   flux.kc             ! Michaelis-Menten constant for CO2 (umol/mol)
%   flux.ko             ! Michaelis-Menten constant for O2 (mmol/mol)
%   flux.je             ! Electron transport rate (umol/m2/s)
%   flux.kp_c4          ! C4: Initial slope of CO2 response curve (mol/m2/s)
%   flux.ac             ! Leaf Rubisco-limited gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.aj             ! Leaf RuBP regeneration-limited gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.ap             ! Leaf product-limited (C3) or CO2-limited (C4) gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.ag             ! Leaf gross photosynthesis (umol CO2/m2 leaf/s)
%   flux.an             ! Leaf net photosynthesis (umol CO2/m2 leaf/s)
%   flux.rd             ! Leaf respiration rate (umol CO2/m2 leaf/s)
%   flux.cs             ! Leaf surface CO2 (umol/mol)
%   flux.ci             ! Leaf intercellular CO2 (umol/mol)
%   flux.hs             ! Leaf fractional humidity at surface (dimensionless)
%   flux.vpd            ! Leaf vapor pressure deficit at surface (Pa)
% ------------------------------------------------------

% --- Adjust photosynthetic parameters for temperature

if (leaf.c3psn == 1)

   % C3 temperature response

   ft = @(tl, ha) exp(ha/(physcon.rgas*(physcon.tfrz+25)) * (1-(physcon.tfrz+25)/tl));
   fth = @(tl, hd, se, fc) fc / (1 + exp((-hd+se*tl)/(physcon.rgas*tl)));

   flux.kc = leaf.kc25 * ft(flux.tleaf, leaf.kcha);
   flux.ko = leaf.ko25 * ft(flux.tleaf, leaf.koha);
   flux.cp = leaf.cp25 * ft(flux.tleaf, leaf.cpha);

   t1 = ft(flux.tleaf, leaf.vcmaxha);
   t2 = fth(flux.tleaf, leaf.vcmaxhd, leaf.vcmaxse, leaf.vcmaxc);
   flux.vcmax = leaf.vcmax25 * t1 * t2;

   t1 = ft(flux.tleaf, leaf.jmaxha);
   t2 = fth(flux.tleaf, leaf.jmaxhd, leaf.jmaxse, leaf.jmaxc);
   flux.jmax = leaf.jmax25 * t1 * t2;

   t1 = ft(flux.tleaf, leaf.rdha);
   t2 = fth(flux.tleaf, leaf.rdhd, leaf.rdse, leaf.rdc);
   flux.rd = leaf.rd25 * t1 * t2;

   flux.kp_c4 = 0;

elseif (leaf.c3psn == 0)

   % C4 temperature response

   t1 = 2^((flux.tleaf-(physcon.tfrz+25)) / 10);
   t2 = 1 + exp(0.2*((physcon.tfrz+15)-flux.tleaf));
   t3 = 1 + exp(0.3*(flux.tleaf-(physcon.tfrz+40)));
   flux.vcmax = leaf.vcmax25 * t1 / (t2 * t3);

   t3 = 1 + exp(1.3*(flux.tleaf-(physcon.tfrz+55)));
   flux.rd = leaf.rd25  * t1 / t3;

   flux.kp_c4 = leaf.kp25_c4 * t1;

   flux.kc = 0;
   flux.ko = 0;
   flux.cp = 0;
   flux.jmax = 0;
   flux.je = 0;

end

% --- Electron transport rate for C3 plants

% Solve the polynomial: aquad*Je^2 + bquad*Je + cquad = 0
% for Je. Correct solution is the smallest of the two roots.

if (leaf.c3psn == 1)
   qabs = 0.5 * leaf.phi_psii * flux.apar;
   aquad = leaf.theta_j;
   bquad = -(qabs + flux.jmax);
   cquad = qabs * flux.jmax;
   pcoeff = [aquad bquad cquad];
   proots = roots(pcoeff);
   flux.je = min(proots(1), proots(2));
end

% --- Ci calculation

if (leaf.gstyp <= 1)

   % Initial estimates for Ci

   if (leaf.c3psn == 1)
      ci0 = 0.7 * atmos.co2air;
   elseif (leaf.c3psn == 0)
      ci0 = 0.4 * atmos.co2air;
   end
   ci1 = ci0 * 0.99;

   % Solve for Ci: Use CiFunc to iterate photosynthesis calculations
   % until the change in Ci is < tol. Ci has units umol/mol

   tol = 0.1;                 % Accuracy tolerance for Ci (umol/mol)
   func_name = 'CiFunc';      % The function name

   [flux, dummy] = hybrid_root (func_name, physcon, atmos, leaf, flux, ci0, ci1, tol);
   flux.ci = dummy;

elseif (leaf.gstyp == 2)

   % Calculate photosynthesis for a specified stomatal conductance

   [flux] = CiFuncOptimization (atmos, leaf, flux);

end

% --- Relative humidity and vapor pressure at leaf surface

[esat, desat] = satvap ((flux.tleaf-physcon.tfrz));
flux.hs = (flux.gbv * atmos.eair + flux.gs * esat) / ((flux.gbv + flux.gs) * esat);
flux.vpd = max(esat - flux.hs*esat, 0.1);

% --- Make sure iterative solution is correct

if (flux.gs < 0)
   error ('LeafPhotosynthesis: negative stomatal conductance')
end

% Compare with Ball-Berry model. The solution blows up with low eair. In input
% data, eair should be > 0.05*esat to ensure that hs does not go to zero.

if (leaf.gstyp == 1)
   gs_err = leaf.g1 * max(flux.an, 0) * flux.hs / flux.cs + leaf.g0;
   if (abs(flux.gs-gs_err)*1e06 > 1e-04)
      fprintf('gs = %15.4f\n', flux.gs)
      fprintf('gs_err = %15.4f\n', gs_err)
      error ('LeafPhotosynthesis: failed Ball-Berry error check')
   end
end

% Compare with Medlyn model. The solutions blows up with vpd = 0. The
% quadratic calcuation of gsw in CiFunc constrains vpd > 50 Pa, so this
% comparison is only valid for those conditions.

if (leaf.gstyp == 0)
   if ((esat - atmos.eair) > 50)
      gs_err = 1.6 * (1 + leaf.g1 / sqrt(flux.vpd*0.001)) * max(flux.an, 0) / flux.cs + leaf.g0;
      if (abs(flux.gs-gs_err)*1e06 > 1e-04)
         fprintf('gs = %15.4f\n', flux.gs)
         fprintf('gs_err = %15.4f\n', gs_err)
         error ('LeafPhotosynthesis: failed Medlyn error check')
      end
   end
end

% Compare with diffusion equation: An = (ca - ci) * gleaf

an_err = (atmos.co2air - flux.ci) / (1 / flux.gbc + 1.6 / flux.gs);
if (flux.an > 0 & abs(flux.an-an_err) > 0.01)
   fprintf('An = %15.4f\n', flux.an)
   fprintf('An_err = %15.4f\n', an_err)
   error ('LeafPhotosynthesis: failed diffusion error check')
end
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `LeafPhysiologyParams.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/LeafPhysiologyParams.m)
  </summary>

```matlab
function [leaf] = LeafPhysiologyParams (params, physcon, leaf)

% ------------------------------------------------------
% Input
%   params.vis          ! Waveband index for visible radiation
%   physcon.tfrz        ! Freezing point of water (K)
%   physcon.rgas        ! Universal gas constant (J/K/mol)
%   leaf.c3psn          ! Photosynthetic pathway: 1 = C3. 0 = C4 plant
%   leaf.gstyp          ! Stomatal conductance: 0 = Medlyn. 1 = Ball-Berry. 2 = WUE optimization
%
% Output
%   leaf.vcmax25        ! Maximum carboxylation rate at 25C (umol/m2/s)
%   leaf.jmax25         ! Maximum electron transport rate at 25C (umol/m2/s)
%   leaf.rd25           ! Leaf respiration rate at 25C (umol CO2/m2/s)
%   leaf.kc25           ! Michaelis-Menten constant for CO2 at 25C (umol/mol)
%   leaf.ko25           ! Michaelis-Menten constant for O2 at 25C (mmol/mol)
%   leaf.cp25           ! CO2 compensation point at 25C (umol/mol)
%   leaf.kcha           ! Activation energy for Kc (J/mol)
%   leaf.koha           ! Activation energy for Ko (J/mol)
%   leaf.cpha           ! Activation energy for Cp (J/mol)
%   leaf.vcmaxha        ! Activation energy for Vcmax (J/mol)
%   leaf.jmaxha         ! Activation energy for Jmax (J/mol)
%   leaf.rdha           ! Activation energy for Rd (J/mol)
%   leaf.vcmaxhd        ! Deactivation energy for Vcmax (J/mol)
%   leaf.jmaxhd         ! Deactivation energy for Jmax (J/mol)
%   leaf.rdhd           ! Deactivation energy for Rd (J/mol)
%   leaf.vcmaxse        ! Entropy term for Vcmax (J/mol/K)
%   leaf.jmaxse         ! Entropy term for Jmax (J/mol/K)
%   leaf.rdse           ! Entropy term for Rd (J/mol/K)
%   leaf.vcmaxc         ! Vcmax scaling factor for high temperature inhibition (25 C = 1.0)
%   leaf.jmaxc          ! Jmax scaling factor for high temperature inhibition (25 C = 1.0)
%   leaf.rdc            ! Rd scaling factor for high temperature inhibition (25 C = 1.0)
%   leaf.phi_psii       ! Quantum yield of PS II
%   leaf.theta_j        ! Empirical curvature parameter for electron transport rate
%   leaf.colim_c3       ! Empirical curvature parameter for C3 co-limitation
%   leaf.colim_c4a      ! Empirical curvature parameter for C4 co-limitation
%   leaf.colim_c4b      ! Empirical curvature parameter for C4 co-limitation
%   leaf.qe_c4          ! C4: Quantum yield (mol CO2 / mol photons)
%   leaf.kp25_c4        ! C4: Initial slope of CO2 response curve at 25C (mol/m2/s)
%   leaf.g0             ! Minimum leaf conductance (mol H2O/m2/s)
%   leaf.g1             ! Slope of conductance-photosynthesis relationship
%   leaf.dleaf          ! Leaf dimension (m)
%   leaf.rho            ! Leaf reflectance for visible (vis) and near-infrared (nir) wavebands
%   leaf.tau            ! Leaf transmittance for visible (vis) and near-infrared (nir) wavebands
%   leaf.iota           ! Stomatal efficiency (umol CO2/ mol H2O)
%   leaf.iota25         ! Stomatal efficiency at 25C (umol CO2/ mol H2O)
% ------------------------------------------------------

% --- Vcmax and other parameters (at 25C)

if (leaf.c3psn == 1)
   leaf.vcmax25 = 57.7;
   leaf.jmax25 = 1.67 * leaf.vcmax25;
   leaf.kp25_c4 = 0;
   leaf.rd25 = 0.015 * leaf.vcmax25;
else
   leaf.vcmax25 = 40;
   leaf.jmax25 = 0;
   leaf.kp25_c4 = 0.02 * leaf.vcmax25;
   leaf.rd25 = 0.025 * leaf.vcmax25;
end

% --- Kc, Ko, Cp at 25C

leaf.kc25 = 404.9;
leaf.ko25 = 278.4;
leaf.cp25 = 42.75;

% --- Activation energy

leaf.kcha = 79430;
leaf.koha = 36380;
leaf.cpha = 37830;
leaf.rdha = 46390;
leaf.vcmaxha = 65330;
leaf.jmaxha  = 43540;

% --- High temperature deactivation

% Deactivation energy (J/mol)

leaf.rdhd = 150000;
leaf.vcmaxhd = 150000;
leaf.jmaxhd  = 150000;

% Entropy term (J/mol/K)

leaf.rdse = 490;
leaf.vcmaxse = 490;
leaf.jmaxse  = 490;

% Scaling factors for high temperature inhibition (25 C = 1.0).
% The factor "c" scales the deactivation to a value of 1.0 at 25C.

fth25 = @(hd, se) 1 + exp((-hd + se*(physcon.tfrz+25)) / (physcon.rgas*(physcon.tfrz+25)));
leaf.vcmaxc = fth25 (leaf.vcmaxhd, leaf.vcmaxse);
leaf.jmaxc  = fth25 (leaf.jmaxhd, leaf.jmaxse);
leaf.rdc    = fth25 (leaf.rdhd, leaf.rdse);

% --- C3 parameters

% Quantum yield of PS II

leaf.phi_psii = 0.85;

% Empirical curvature parameter for electron transport rate

leaf.theta_j = 0.90;

% Empirical curvature parameter for C3 co-limitation

leaf.colim_c3 = 0.98;

% Empirical curvature parameters for C4 co-limitation

leaf.colim_c4a = 0.80;
leaf.colim_c4b = 0.95;

% --- C4: Quantum yield (mol CO2 / mol photons)

leaf.qe_c4 = 0.05;

% --- Stomatal conductance parameters

if (leaf.c3psn == 1)

   if (leaf.gstyp == 1)
      leaf.g0 = 0.01;       % Ball-Berry minimum leaf conductance (mol H2O/m2/s)
      leaf.g1 = 9.0;        % Ball-Berry slope of conductance-photosynthesis relationship
   elseif (leaf.gstyp == 0)
      leaf.g0 = 0.0;        % Medlyn minimum leaf conductance (mol H2O/m2/s)
      leaf.g1 = 4.45;       % Medlyn slope of conductance-photosynthesis relationship
%     leaf.g1 = 2.8;        % To match Ball-Berry g1 = 9
   end

else

   if (leaf.gstyp == 1)
      leaf.g0 = 0.04;       % Ball-Berry minimum leaf conductance (mol H2O/m2/s)
      leaf.g1 = 4.0;        % Ball-Berry slope of conductance-photosynthesis relationship
   elseif (leaf.gstyp == 0)
      leaf.g0 = 0.0;        % Medlyn minimum leaf conductance (mol H2O/m2/s)
      leaf.g1 = 1.62;       % Medlyn slope of conductance-photosynthesis relationship
   end

end

% --- Stomatal efficiency for optimization (An/E; umol CO2/ mol H2O)

if (leaf.gstyp == 2)
   leaf.iota25 = 750;
%  leaf.iota25 = 1400;      % To match Ball-Berry g1 = 9
   leaf.iota = leaf.iota25;
end

% --- Leaf dimension (m)

leaf.dleaf = 0.05;

% --- Leaf reflectance and transmittance: visible and near-infrared wavebands

leaf.rho(params.vis) = 0.10;
leaf.tau(params.vis) = 0.10;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `LeafTranspiration.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/LeafTranspiration.m)
  </summary>

```matlab
function [flux] = LeafTranspiration (physcon, atmos, flux)

% Leaf transpiration flux

% ------------------------------------------------------
% Input
%   physcon.tfrz     ! Freezing point of water (K)
%   physcon.mmh2o    ! Molecular mass of water (kg/mol)
%   atmos.patm       ! Atmospheric pressure (Pa)
%   atmos.tair       ! Air temperature (K)
%   atmos.eair       ! Vapor pressure of air (Pa)
%   flux.gbv         ! Leaf boundary layer conductance, H2O (mol H2O/m2 leaf/s)
%   flux.gs          ! Leaf stomatal conductance (mol H2O/m2 leaf/s)
%   flux.tleaf       ! Leaf temperature (K)
%
% Output
%   flux.lhflx       ! Leaf latent heat flux (W/m2 leaf)
%   flux.etflx       ! Leaf transpiration flux (mol H2O/m2 leaf/s)
% ------------------------------------------------------

% Latent heat of vaporization (J/mol)

[lambda_val] = latvap ((atmos.tair-physcon.tfrz), physcon.mmh2o);

% Saturation vapor pressure (Pa) and temperature derivative (Pa/K)

[esat, desat] = satvap ((flux.tleaf-physcon.tfrz));

% Leaf conductance for water vapor (mol H2O/m2/s)

gleaf = flux.gs * flux.gbv / (flux.gs + flux.gbv);

% Latent heat flux (W/m2)

flux.lhflx = lambda_val / atmos.patm * (esat - atmos.eair) * gleaf;

% Water vapor flux: W/m2 -> mol H2O/m2/s

flux.etflx = flux.lhflx / lambda_val;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `satvap.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/satvap.m)
  </summary>

```matlab
function [esat, desat] = satvap (tc)

% Compute saturation vapor pressure and change in saturation vapor pressure
% with respect to temperature. Polynomial approximations are from:
% Flatau et al. (1992) Polynomial fits to saturation vapor pressure.
% Journal of Applied Meteorology 31:1507-1513. Input temperature is Celsius.

% --- For water vapor (temperature range is 0C to 100C)
 
a0 =  6.11213476;        b0 =  0.444017302;
a1 =  0.444007856;       b1 =  0.286064092e-01;
a2 =  0.143064234e-01;   b2 =  0.794683137e-03;
a3 =  0.264461437e-03;   b3 =  0.121211669e-04;
a4 =  0.305903558e-05;   b4 =  0.103354611e-06;
a5 =  0.196237241e-07;   b5 =  0.404125005e-09;
a6 =  0.892344772e-10;   b6 = -0.788037859e-12;
a7 = -0.373208410e-12;   b7 = -0.114596802e-13;
a8 =  0.209339997e-15;   b8 =  0.381294516e-16;
 
% --- For ice (temperature range is -75C to 0C)
 
c0 =  6.11123516;        d0 =  0.503277922;
c1 =  0.503109514;       d1 =  0.377289173e-01;
c2 =  0.188369801e-01;   d2 =  0.126801703e-02;
c3 =  0.420547422e-03;   d3 =  0.249468427e-04;
c4 =  0.614396778e-05;   d4 =  0.313703411e-06;
c5 =  0.602780717e-07;   d5 =  0.257180651e-08;
c6 =  0.387940929e-09;   d6 =  0.133268878e-10;
c7 =  0.149436277e-11;   d7 =  0.394116744e-13;
c8 =  0.262655803e-14;   d8 =  0.498070196e-16;

% --- Limit temperature to -75C to 100C
 
tc = min(tc, 100);
tc = max(tc, -75);

% --- Saturation vapor pressure (esat, mb) and derivative (desat, mb)

if (tc >= 0)
   esat  = a0 + tc*(a1 + tc*(a2 + tc*(a3 + tc*(a4 ...
         + tc*(a5 + tc*(a6 + tc*(a7 + tc*a8)))))));
   desat = b0 + tc*(b1 + tc*(b2 + tc*(b3 + tc*(b4 ...
         + tc*(b5 + tc*(b6 + tc*(b7 + tc*b8)))))));
else
   esat  = c0 + tc*(c1 + tc*(c2 + tc*(c3 + tc*(c4 ...
         + tc*(c5 + tc*(c6 + tc*(c7 + tc*c8)))))));
   desat = d0 + tc*(d1 + tc*(d2 + tc*(d3 + tc*(d4 ...
         + tc*(d5 + tc*(d6 + tc*(d7 + tc*d8)))))));
end

% --- Convert from mb to Pa

esat  = esat  * 100;
desat = desat * 100;
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `StomataEfficiency.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/StomataEfficiency.m)
  </summary>

```matlab
function [flux, val] = StomataEfficiency (physcon, atmos, leaf, flux, gs_val)

% Stomatal efficiency check to determine maximum gs. For the stomatal conductance
% gs_val, calculate photosynthesis for an increase in stomatal conductance equal
% to "delta". The returned value is positive if this increase produces a change
% in photosynthesis > iota*vpd*delta. The returned value is negative if the increase
% produces a change in photosynthesis < iota*vpd*delta.

% --- Specify "delta" as a small difference in gs (mol H2O/m2/s)

delta = 0.001;

% -- Calculate photosynthesis at lower gs (gs_val - delta)
% gs2 - lower value for gs (mol H2O/m2/s)
% an2 - leaf photosynthesis at gs2 (umol CO2/m2/s)

gs2 = gs_val - delta;
flux.gs = gs2;
[flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
an2 = flux.an;

% -- Calculate photosynthesis at higher gs (gs_val)
% gs1 - higher value for gs (mol H2O/m2/s)
% an1 - leaf photosynthesis at gs1 (umol CO2/m2/s)

gs1 = gs_val;
flux.gs = gs1;
[flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
an1 = flux.an;

% --- Efficiency check: val < 0 when d(An) / d(gs) < iota * vpd

val = (an1 - an2) - leaf.iota * delta * (flux.vpd / atmos.patm);
```
{: .aux-program-code}

</details>

<details>
  <summary markdown="span">
    `StomataOptimization.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/StomataOptimization.m)
  </summary>

```matlab
function [flux] = StomataOptimization (physcon, atmos, leaf, flux)

% Leaf temperature, energy fluxes, photosynthesis, and stomatal conductance
% with water-use efficiency stomatal optimization

% --- Low and high initial estimates for gs (mol H2O/m2/s)

gs1 = 0.002;
gs2 = 2.0;

% --- Check for minimum stomatal conductance linked to low light
% based on the efficiency check for gs1 and gs2 (check1, check2)

[flux, check1] = StomataEfficiency (physcon, atmos, leaf, flux, gs1);
[flux, check2] = StomataEfficiency (physcon, atmos, leaf, flux, gs2);

if (check1 * check2 < 0)

   % Calculate gs using the function StomataEfficiency to iterate gs
   % to an accuracy of tol (mol H2O/m2/s)

   tol = 0.004;
   func_name = 'StomataEfficiency';
   [flux, root] = brent_root (func_name, physcon, atmos, leaf, flux, gs1, gs2, tol);
   flux.gs = root;

else

   % Low light. Set gs to minimum conductance

   flux.gs = 0.002;

end

% --- Leaf fluxes for this gs

[flux] = LeafPhotosynthesis (physcon, atmos, leaf, flux);
[flux] = LeafTranspiration (physcon, atmos, flux);
```
{: .aux-program-code}

</details>

# Output

## Figures

Figure 1

<img src="https://raw.githubusercontent.com/zmoon92/bonanmodeling/gh-pages-dev/sp_12_01/fig01.png">

## Text

<details>
  <summary markdown="span">
    `light_response.txt`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_12_01/light_response.txt)
    <span class="program-code-link-sep">|</span>
    [View raw](https://raw.githubusercontent.com/zmoon92/bonanmodeling/gh-pages-dev/sp_12_01/light_response.txt)
  </summary>

```
0.0   25.0  380.0    0.6338    0.8000    0.7000   12.3481   -0.8655   -0.8655   -0.8655    0.0000    2.0215
  10.0   25.0  380.0    0.6338    0.8000    0.7000   12.3481   -0.3276   -0.8655   -0.3281    0.0000    2.0215
  20.0   25.0  380.0    0.6338    0.8007    0.8481   14.7757    0.2911   -0.8655    0.2893    0.0080    2.0215
  30.0   25.0  380.0    0.6338    0.8021    0.8478   14.7707    0.8620   -0.8655    0.8578    0.0239    2.0215
  40.0   25.0  380.0    0.6338    0.8035    0.8474   14.7657    1.4275   -0.8655    1.4197    0.0398    2.0215
  50.0   25.0  380.0    0.6338    0.8049    0.8471   14.7607    1.9870   -0.8655    1.9744    0.0555    2.0215
  60.0   25.0  380.0    0.6338    0.8062    0.8468   14.7558    2.5400   -0.8655    2.5213    0.0712    2.0215
  70.0   25.0  380.0    0.6338    0.8075    0.8465   14.7509    3.0859   -0.8655    3.0596    0.0867    2.0215
  80.0   25.0  380.0    0.6338    0.8088    0.8462   14.7462    3.6241   -0.8655    3.5886    0.1021    2.0215
  90.0   25.0  380.0    0.6338    0.8100    0.8459   14.7414    4.1540   -0.8655    4.1075    0.1173    2.0215
 100.0   25.0  380.0    0.6338    0.8112    0.8456   14.7368    4.6747   -0.8655    4.6153    0.1322    2.0215
 110.0   25.0  380.0    0.6338    0.8124    0.8453   14.7322    5.1854   -0.8655    5.1112    0.1469    2.0215
 120.0   25.0  380.0    0.6338    0.8135    0.8450   14.7278    5.6854   -0.8655    5.5941    0.1613    2.0215
 130.0   25.0  380.0    0.6338    0.8146    0.8448   14.7234    6.1738   -0.8655    6.0629    0.1754    2.0215
 140.0   25.0  380.0    0.6338    0.8157    0.8445   14.7192    6.6495   -0.8655    6.5167    0.1892    2.0215
 150.0   25.0  380.0    0.6338    0.8167    0.8442   14.7151    7.1118   -0.8655    6.9542    0.2025    2.0215
 160.0   25.0  380.0    0.6338    0.8177    0.8440   14.7111    7.5596   -0.8655    7.3745    0.2154    2.0215
 170.0   25.0  380.0    0.6338    0.8186    0.8437   14.7073    7.9920   -0.8655    7.7765    0.2277    2.0215
 180.0   25.0  380.0    0.6338    0.8194    0.8435   14.7037    8.4081   -0.8655    8.1592    0.2396    2.0215
 190.0   25.0  380.0    0.6338    0.8203    0.8433   14.7002    8.8072   -0.8655    8.5219    0.2509    2.0215
 200.0   25.0  380.0    0.6338    0.8210    0.8431   14.6969    9.1885   -0.8655    8.8640    0.2616    2.0215
 210.0   25.0  380.0    0.6338    0.8218    0.8429   14.6938    9.5516   -0.8655    9.1849    0.2717    2.0215
 220.0   25.0  380.0    0.6338    0.8224    0.8427   14.6909    9.8959   -0.8655    9.4844    0.2811    2.0215
 230.0   25.0  380.0    0.6338    0.8231    0.8425   14.6882   10.2213   -0.8655    9.7626    0.2899    2.0215
 240.0   25.0  380.0    0.6338    0.8236    0.8424   14.6857   10.5277   -0.8655   10.0198    0.2981    2.0215
 250.0   25.0  380.0    0.6338    0.8242    0.8422   14.6834   10.8153   -0.8655   10.2565    0.3057    2.0215
 260.0   25.0  380.0    0.6338    0.8246    0.8421   14.6812   11.0846   -0.8655   10.4735    0.3126    2.0215
 270.0   25.0  380.0    0.6338    0.8251    0.8420   14.6793   11.3359   -0.8655   10.6716    0.3190    2.0215
 280.0   25.0  380.0    0.6338    0.8255    0.8419   14.6775   11.5700   -0.8655   10.8521    0.3248    2.0215
 290.0   25.0  380.0    0.6338    0.8258    0.8418   14.6758   11.7876   -0.8655   11.0161    0.3301    2.0215
 300.0   25.0  380.0    0.6338    0.8262    0.8417   14.6743   11.9896   -0.8655   11.1648    0.3349    2.0215
 310.0   25.0  380.0    0.6338    0.8265    0.8416   14.6730   12.1770   -0.8655   11.2996    0.3392    2.0215
 320.0   25.0  380.0    0.6338    0.8267    0.8415   14.6718   12.3507   -0.8655   11.4216    0.3432    2.0215
 330.0   25.0  380.0    0.6338    0.8270    0.8414   14.6707   12.5116   -0.8655   11.5321    0.3468    2.0215
 340.0   25.0  380.0    0.6338    0.8272    0.8414   14.6697   12.6606   -0.8655   11.6322    0.3500    2.0215
 350.0   25.0  380.0    0.6338    0.8274    0.8413   14.6688   12.7988   -0.8655   11.7229    0.3530    2.0215
 360.0   25.0  380.0    0.6338    0.8276    0.8413   14.6680   12.9269   -0.8655   11.8052    0.3557    2.0215
 370.0   25.0  380.0    0.6338    0.8277    0.8412   14.6672   13.0457   -0.8655   11.8800    0.3581    2.0215
 380.0   25.0  380.0    0.6338    0.8279    0.8412   14.6665   13.1561   -0.8655   11.9481    0.3603    2.0215
 390.0   25.0  380.0    0.6338    0.8280    0.8411   14.6659   13.2588   -0.8655   12.0102    0.3624    2.0215
 400.0   25.0  380.0    0.6338    0.8281    0.8411   14.6654   13.3543   -0.8655   12.0670    0.3642    2.0215
 410.0   25.0  380.0    0.6338    0.8283    0.8411   14.6649   13.4433   -0.8655   12.1189    0.3659    2.0215
 420.0   25.0  380.0    0.6338    0.8284    0.8410   14.6644   13.5264   -0.8655   12.1665    0.3675    2.0215
 430.0   25.0  380.0    0.6338    0.8285    0.8410   14.6640   13.6039   -0.8655   12.2103    0.3689    2.0215
 440.0   25.0  380.0    0.6338    0.8285    0.8410   14.6636   13.6765   -0.8655   12.2506    0.3703    2.0215
 450.0   25.0  380.0    0.6338    0.8286    0.8410   14.6632   13.7445   -0.8655   12.2878    0.3715    2.0215
 460.0   25.0  380.0    0.6338    0.8287    0.8410   14.6629   13.8083   -0.8655   12.3222    0.3726    2.0215
 470.0   25.0  380.0    0.6338    0.8288    0.8409   14.6626   13.8682   -0.8655   12.3541    0.3737    2.0215
 480.0   25.0  380.0    0.6338    0.8288    0.8409   14.6623   13.9246   -0.8655   12.3837    0.3746    2.0215
 490.0   25.0  380.0    0.6338    0.8289    0.8409   14.6620   13.9777   -0.8655   12.4113    0.3755    2.0215
 500.0   25.0  380.0    0.6338    0.8289    0.8409   14.6618   14.0277   -0.8655   12.4370    0.3764    2.0215
 510.0   25.0  380.0    0.6338    0.8290    0.8409   14.6615   14.0750   -0.8655   12.4609    0.3772    2.0215
 520.0   25.0  380.0    0.6338    0.8290    0.8409   14.6613   14.1196   -0.8655   12.4833    0.3779    2.0215
 530.0   25.0  380.0    0.6338    0.8291    0.8408   14.6611   14.1619   -0.8655   12.5043    0.3786    2.0215
 540.0   25.0  380.0    0.6338    0.8291    0.8408   14.6609   14.2020   -0.8655   12.5240    0.3793    2.0215
 550.0   25.0  380.0    0.6338    0.8292    0.8408   14.6607   14.2400   -0.8655   12.5425    0.3799    2.0215
 560.0   25.0  380.0    0.6338    0.8292    0.8408   14.6606   14.2761   -0.8655   12.5600    0.3804    2.0215
 570.0   25.0  380.0    0.6338    0.8292    0.8408   14.6604   14.3104   -0.8655   12.5764    0.3810    2.0215
 580.0   25.0  380.0    0.6338    0.8293    0.8408   14.6603   14.3430   -0.8655   12.5919    0.3815    2.0215
 590.0   25.0  380.0    0.6338    0.8293    0.8408   14.6601   14.3741   -0.8655   12.6065    0.3820    2.0215
 600.0   25.0  380.0    0.6338    0.8293    0.8408   14.6600   14.4038   -0.8655   12.6204    0.3824    2.0215
 610.0   25.0  380.0    0.6338    0.8294    0.8408   14.6599   14.4321   -0.8655   12.6336    0.3829    2.0215
 620.0   25.0  380.0    0.6338    0.8294    0.8408   14.6598   14.4592   -0.8655   12.6460    0.3833    2.0215
 630.0   25.0  380.0    0.6338    0.8294    0.8407   14.6596   14.4850   -0.8655   12.6579    0.3837    2.0215
 640.0   25.0  380.0    0.6338    0.8294    0.8407   14.6595   14.5098   -0.8655   12.6691    0.3840    2.0215
 650.0   25.0  380.0    0.6338    0.8295    0.8407   14.6594   14.5335   -0.8655   12.6798    0.3844    2.0215
 660.0   25.0  380.0    0.6338    0.8295    0.8407   14.6593   14.5563   -0.8655   12.6901    0.3847    2.0215
 670.0   25.0  380.0    0.6338    0.8295    0.8407   14.6592   14.5781   -0.8655   12.6998    0.3851    2.0215
 680.0   25.0  380.0    0.6338    0.8295    0.8407   14.6592   14.5990   -0.8655   12.7091    0.3854    2.0215
 690.0   25.0  380.0    0.6338    0.8296    0.8407   14.6591   14.6191   -0.8655   12.7180    0.3857    2.0215
 700.0   25.0  380.0    0.6338    0.8296    0.8407   14.6590   14.6385   -0.8655   12.7265    0.3859    2.0215
 710.0   25.0  380.0    0.6338    0.8296    0.8407   14.6589   14.6571   -0.8655   12.7346    0.3862    2.0215
 720.0   25.0  380.0    0.6338    0.8296    0.8407   14.6588   14.6750   -0.8655   12.7424    0.3865    2.0215
 730.0   25.0  380.0    0.6338    0.8296    0.8407   14.6588   14.6923   -0.8655   12.7499    0.3867    2.0215
 740.0   25.0  380.0    0.6338    0.8296    0.8407   14.6587   14.7089   -0.8655   12.7571    0.3869    2.0215
 750.0   25.0  380.0    0.6338    0.8297    0.8407   14.6586   14.7250   -0.8655   12.7640    0.3872    2.0215
 760.0   25.0  380.0    0.6338    0.8297    0.8407   14.6586   14.7404   -0.8655   12.7706    0.3874    2.0215
 770.0   25.0  380.0    0.6338    0.8297    0.8407   14.6585   14.7554   -0.8655   12.7770    0.3876    2.0215
 780.0   25.0  380.0    0.6338    0.8297    0.8407   14.6585   14.7699   -0.8655   12.7831    0.3878    2.0215
 790.0   25.0  380.0    0.6338    0.8297    0.8407   14.6584   14.7838   -0.8655   12.7891    0.3880    2.0215
 800.0   25.0  380.0    0.6338    0.8297    0.8407   14.6583   14.7974   -0.8655   12.7948    0.3882    2.0215
 810.0   25.0  380.0    0.6338    0.8297    0.8407   14.6583   14.8104   -0.8655   12.8002    0.3884    2.0215
 820.0   25.0  380.0    0.6338    0.8297    0.8407   14.6582   14.8231   -0.8655   12.8055    0.3885    2.0215
 830.0   25.0  380.0    0.6338    0.8298    0.8406   14.6582   14.8354   -0.8655   12.8107    0.3887    2.0215
 840.0   25.0  380.0    0.6338    0.8298    0.8406   14.6582   14.8473   -0.8655   12.8156    0.3889    2.0215
 850.0   25.0  380.0    0.6338    0.8298    0.8406   14.6581   14.8588   -0.8655   12.8204    0.3890    2.0215
 860.0   25.0  380.0    0.6338    0.8298    0.8406   14.6581   14.8700   -0.8655   12.8250    0.3892    2.0215
 870.0   25.0  380.0    0.6338    0.8298    0.8406   14.6580   14.8809   -0.8655   12.8295    0.3893    2.0215
 880.0   25.0  380.0    0.6338    0.8298    0.8406   14.6580   14.8914   -0.8655   12.8338    0.3895    2.0215
 890.0   25.0  380.0    0.6338    0.8298    0.8406   14.6579   14.9016   -0.8655   12.8380    0.3896    2.0215
 900.0   25.0  380.0    0.6338    0.8298    0.8406   14.6579   14.9116   -0.8655   12.8421    0.3898    2.0215
 910.0   25.0  380.0    0.6338    0.8298    0.8406   14.6579   14.9213   -0.8655   12.8460    0.3899    2.0215
 920.0   25.0  380.0    0.6338    0.8298    0.8406   14.6578   14.9307   -0.8655   12.8498    0.3900    2.0215
 930.0   25.0  380.0    0.6338    0.8298    0.8406   14.6578   14.9398   -0.8655   12.8535    0.3901    2.0215
 940.0   25.0  380.0    0.6338    0.8299    0.8406   14.6578   14.9487   -0.8655   12.8571    0.3903    2.0215
 950.0   25.0  380.0    0.6338    0.8299    0.8406   14.6577   14.9574   -0.8655   12.8606    0.3904    2.0215
 960.0   25.0  380.0    0.6338    0.8299    0.8406   14.6577   14.9658   -0.8655   12.8640    0.3905    2.0215
 970.0   25.0  380.0    0.6338    0.8299    0.8406   14.6577   14.9740   -0.8655   12.8673    0.3906    2.0215
 980.0   25.0  380.0    0.6338    0.8299    0.8406   14.6576   14.9820   -0.8655   12.8705    0.3907    2.0215
 990.0   25.0  380.0    0.6338    0.8299    0.8406   14.6576   14.9898   -0.8655   12.8736    0.3908    2.0215
1000.0   25.0  380.0    0.6338    0.8299    0.8406   14.6576   14.9975   -0.8655   12.8767    0.3909    2.0215
1010.0   25.0  380.0    0.6338    0.8299    0.8406   14.6576   15.0049   -0.8655   12.8796    0.3910    2.0215
1020.0   25.0  380.0    0.6338    0.8299    0.8406   14.6575   15.0121   -0.8655   12.8825    0.3911    2.0215
1030.0   25.0  380.0    0.6338    0.8299    0.8406   14.6575   15.0192   -0.8655   12.8853    0.3912    2.0215
1040.0   25.0  380.0    0.6338    0.8299    0.8406   14.6575   15.0261   -0.8655   12.8880    0.3913    2.0215
1050.0   25.0  380.0    0.6338    0.8299    0.8406   14.6574   15.0328   -0.8655   12.8907    0.3914    2.0215
1060.0   25.0  380.0    0.6338    0.8299    0.8406   14.6574   15.0394   -0.8655   12.8933    0.3915    2.0215
1070.0   25.0  380.0    0.6338    0.8299    0.8406   14.6574   15.0458   -0.8655   12.8958    0.3915    2.0215
1080.0   25.0  380.0    0.6338    0.8299    0.8406   14.6574   15.0521   -0.8655   12.8983    0.3916    2.0215
1090.0   25.0  380.0    0.6338    0.8299    0.8406   14.6574   15.0583   -0.8655   12.9007    0.3917    2.0215
1100.0   25.0  380.0    0.6338    0.8300    0.8406   14.6573   15.0643   -0.8655   12.9030    0.3918    2.0215
1110.0   25.0  380.0    0.6338    0.8300    0.8406   14.6573   15.0701   -0.8655   12.9053    0.3919    2.0215
1120.0   25.0  380.0    0.6338    0.8300    0.8406   14.6573   15.0759   -0.8655   12.9076    0.3919    2.0215
1130.0   25.0  380.0    0.6338    0.8300    0.8406   14.6573   15.0815   -0.8655   12.9098    0.3920    2.0215
1140.0   25.0  380.0    0.6338    0.8300    0.8406   14.6572   15.0870   -0.8655   12.9119    0.3921    2.0215
1150.0   25.0  380.0    0.6338    0.8300    0.8406   14.6572   15.0924   -0.8655   12.9140    0.3921    2.0215
1160.0   25.0  380.0    0.6338    0.8300    0.8406   14.6572   15.0977   -0.8655   12.9160    0.3922    2.0215
1170.0   25.0  380.0    0.6338    0.8300    0.8406   14.6572   15.1028   -0.8655   12.9180    0.3923    2.0215
1180.0   25.0  380.0    0.6338    0.8300    0.8406   14.6572   15.1079   -0.8655   12.9200    0.3923    2.0215
1190.0   25.0  380.0    0.6338    0.8300    0.8406   14.6572   15.1128   -0.8655   12.9219    0.3924    2.0215
1200.0   25.0  380.0    0.6338    0.8300    0.8406   14.6571   15.1177   -0.8655   12.9238    0.3925    2.0215
1210.0   25.0  380.0    0.6338    0.8300    0.8406   14.6571   15.1225   -0.8655   12.9256    0.3925    2.0215
1220.0   25.0  380.0    0.6338    0.8300    0.8406   14.6571   15.1271   -0.8655   12.9274    0.3926    2.0215
1230.0   25.0  380.0    0.6338    0.8300    0.8406   14.6571   15.1317   -0.8655   12.9292    0.3926    2.0215
1240.0   25.0  380.0    0.6338    0.8300    0.8406   14.6571   15.1362   -0.8655   12.9309    0.3927    2.0215
1250.0   25.0  380.0    0.6338    0.8300    0.8406   14.6571   15.1406   -0.8655   12.9326    0.3928    2.0215
1260.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1449   -0.8655   12.9342    0.3928    2.0215
1270.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1491   -0.8655   12.9358    0.3929    2.0215
1280.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1533   -0.8655   12.9374    0.3929    2.0215
1290.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1574   -0.8655   12.9390    0.3930    2.0215
1300.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1614   -0.8655   12.9405    0.3930    2.0215
1310.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1653   -0.8655   12.9420    0.3931    2.0215
1320.0   25.0  380.0    0.6338    0.8300    0.8406   14.6570   15.1692   -0.8655   12.9435    0.3931    2.0215
1330.0   25.0  380.0    0.6338    0.8300    0.8406   14.6569   15.1730   -0.8655   12.9449    0.3932    2.0215
1340.0   25.0  380.0    0.6338    0.8300    0.8406   14.6569   15.1767   -0.8655   12.9463    0.3932    2.0215
1350.0   25.0  380.0    0.6338    0.8300    0.8406   14.6569   15.1803   -0.8655   12.9477    0.3933    2.0215
1360.0   25.0  380.0    0.6338    0.8300    0.8406   14.6569   15.1839   -0.8655   12.9491    0.3933    2.0215
1370.0   25.0  380.0    0.6338    0.8301    0.8406   14.6569   15.1875   -0.8655   12.9504    0.3933    2.0215
1380.0   25.0  380.0    0.6338    0.8301    0.8406   14.6569   15.1910   -0.8655   12.9517    0.3934    2.0215
1390.0   25.0  380.0    0.6338    0.8301    0.8406   14.6569   15.1944   -0.8655   12.9530    0.3934    2.0215
1400.0   25.0  380.0    0.6338    0.8301    0.8406   14.6569   15.1977   -0.8655   12.9543    0.3935    2.0215
1410.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2010   -0.8655   12.9555    0.3935    2.0215
1420.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2043   -0.8655   12.9567    0.3936    2.0215
1430.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2075   -0.8655   12.9579    0.3936    2.0215
1440.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2106   -0.8655   12.9591    0.3936    2.0215
1450.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2137   -0.8655   12.9603    0.3937    2.0215
1460.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2168   -0.8655   12.9614    0.3937    2.0215
1470.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2198   -0.8655   12.9625    0.3937    2.0215
1480.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2227   -0.8655   12.9636    0.3938    2.0215
1490.0   25.0  380.0    0.6338    0.8301    0.8406   14.6568   15.2256   -0.8655   12.9647    0.3938    2.0215
1500.0   25.0  380.0    0.6338    0.8301    0.8406   14.6567   15.2285   -0.8655   12.9658    0.3939    2.0215
1510.0   25.0  380.0    0.6338    0.8301    0.8406   14.6567   15.2313   -0.8655   12.9668    0.3939    2.0215
1520.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2340   -0.8655   12.9679    0.3939    2.0215
1530.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2368   -0.8655   12.9689    0.3940    2.0215
1540.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2395   -0.8655   12.9699    0.3940    2.0215
1550.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2421   -0.8655   12.9709    0.3940    2.0215
1560.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2447   -0.8655   12.9718    0.3941    2.0215
1570.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2473   -0.8655   12.9728    0.3941    2.0215
1580.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2498   -0.8655   12.9737    0.3941    2.0215
1590.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2523   -0.8655   12.9747    0.3942    2.0215
1600.0   25.0  380.0    0.6338    0.8301    0.8405   14.6567   15.2548   -0.8655   12.9756    0.3942    2.0215
1610.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2572   -0.8655   12.9765    0.3942    2.0215
1620.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2596   -0.8655   12.9774    0.3942    2.0215
1630.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2619   -0.8655   12.9782    0.3943    2.0215
1640.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2643   -0.8655   12.9791    0.3943    2.0215
1650.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2666   -0.8655   12.9799    0.3943    2.0215
1660.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2688   -0.8655   12.9808    0.3944    2.0215
1670.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2710   -0.8655   12.9816    0.3944    2.0215
1680.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2732   -0.8655   12.9824    0.3944    2.0215
1690.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2754   -0.8655   12.9832    0.3944    2.0215
1700.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2775   -0.8655   12.9840    0.3945    2.0215
1710.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2797   -0.8655   12.9848    0.3945    2.0215
1720.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2817   -0.8655   12.9855    0.3945    2.0215
1730.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2838   -0.8655   12.9863    0.3945    2.0215
1740.0   25.0  380.0    0.6338    0.8301    0.8405   14.6566   15.2858   -0.8655   12.9870    0.3946    2.0215
1750.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2878   -0.8655   12.9878    0.3946    2.0215
1760.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2898   -0.8655   12.9885    0.3946    2.0215
1770.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2917   -0.8655   12.9892    0.3946    2.0215
1780.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2937   -0.8655   12.9899    0.3947    2.0215
1790.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2956   -0.8655   12.9906    0.3947    2.0215
1800.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2974   -0.8655   12.9913    0.3947    2.0215
1810.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.2993   -0.8655   12.9920    0.3947    2.0215
1820.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.3011   -0.8655   12.9927    0.3947    2.0215
1830.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.3029   -0.8655   12.9933    0.3948    2.0215
1840.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.3047   -0.8655   12.9940    0.3948    2.0215
1850.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.3065   -0.8655   12.9946    0.3948    2.0215
1860.0   25.0  380.0    0.6338    0.8301    0.8405   14.6565   15.3082   -0.8655   12.9952    0.3948    2.0215
1870.0   25.0  380.0    0.6338    0.8302    0.8405   14.6565   15.3100   -0.8655   12.9959    0.3949    2.0215
1880.0   25.0  380.0    0.6338    0.8302    0.8405   14.6565   15.3117   -0.8655   12.9965    0.3949    2.0215
1890.0   25.0  380.0    0.6338    0.8302    0.8405   14.6565   15.3133   -0.8655   12.9971    0.3949    2.0215
1900.0   25.0  380.0    0.6338    0.8302    0.8405   14.6565   15.3150   -0.8655   12.9977    0.3949    2.0215
1910.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3166   -0.8655   12.9983    0.3949    2.0215
1920.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3183   -0.8655   12.9989    0.3950    2.0215
1930.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3199   -0.8655   12.9995    0.3950    2.0215
1940.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3214   -0.8655   13.0001    0.3950    2.0215
1950.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3230   -0.8655   13.0006    0.3950    2.0215
1960.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3246   -0.8655   13.0012    0.3950    2.0215
1970.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3261   -0.8655   13.0017    0.3951    2.0215
1980.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3276   -0.8655   13.0023    0.3951    2.0215
1990.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3291   -0.8655   13.0028    0.3951    2.0215
2000.0   25.0  380.0    0.6338    0.8302    0.8405   14.6564   15.3306   -0.8655   13.0034    0.3951    2.0215
```
{: .main-program-output-text-file}

</details>