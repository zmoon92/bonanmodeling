---
# note: this file is automatically generated!
chapter_num: 10
chapter_title: 10. Leaf Temperature and Energy Fluxes
sp_id: sp_10_01
sp_id_book: '10.1'
sp_num: 1
sp_title: ''
# 
aux_program_repo_rel_paths: []
main_program_repo_rel_path: sp_10_01/sp_10_01.m
# 
permalink: /ch10/01.html
title: Supplemental Program 10.1
# 
parent: 10. Leaf Temperature and Energy Fluxes
---

# Code

## Main program

<details>
  <summary markdown="span">
    `sp_10_01.m`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_10_01/sp_10_01.m)
  </summary>

```matlab
% Supplemental program 10.1

% -----------------------------------------
% Calculate leaf boundary layer conductance
% -----------------------------------------

% Physical constants

tfrz = 273.15;                       % Freezing point of water (K)
g = 9.80616;                         % Gravitational acceleration (m/s2)
rgas = 8.31447;                      % Universal gas constant (J/K/mol)
visc0 = 13.3e-06;                    % Kinematic viscosity at 0C and 1013.25 hPa (m2/s)
Dh0 = 18.9e-06;                      % Molecular diffusivity (heat) at 0C and 1013.25 hPa (m2/s)
Dv0 = 21.8e-06;                      % Molecular diffusivity (H2O) at 0C and 1013.25 hPa (m2/s)
Dc0 = 13.8e-06;                      % Molecular diffusivity (CO2) at 0C and 1013.25 hPa (m2/s)

% Calculations are for 100 data points that vary in wind speed and/or leaf temperature

num = 100;

% Input variables

for p = 1:num
   tair(p) = tfrz + 15;                      % Air temperature (K)
   pref(p) = 101325;                         % Pressure (Pa)
   rhomol(p) = pref(p) / (rgas * tair(p));   % Molar density (mol/m3)
   wind(p) = p / 10;                         % Wind speed (m/s): 0.1 -> 10 m/s by 0.1
   dleaf(p) = 0.05;                          % Leaf dimension (m)
   tleaf(p) = tair(p) + p / 10;              % tleaf - tair: 0.1 -> 10 K by 0.1 (for free convection)
end

for p = 1:num

   % Adjust diffusivity for temperature and pressure

   fac = 101325 / pref(p) * (tair(p) / tfrz)^1.81;

   visc = visc0 * fac;    % Kinematic viscosity (m2/s)
   Dh = Dh0 * fac;        % Molecular diffusivity, heat (m2/s)
   Dv = Dv0 * fac;        % Molecular diffusivity, H2O (m2/s)
   Dc = Dc0 * fac;        % Molecular diffusivity, CO2 (m2/s)

   % Dimensionless numbers

   Re(p) = wind(p) * dleaf(p) / visc;   % Reynolds number
   Pr  = visc / Dh;                     % Prandtl number
   Scv = visc / Dv;                     % Schmidt number for H2O
   Scc = visc / Dc;                     % Schmidt number for CO2
   Gr = g * dleaf(p)^3 * max(tleaf(p) - tair(p), 0) / (tair(p) * visc * visc); % Grashof number

   % Forced convection - laminar flow

   b1 = 1.5;                                     % Empirical correction factor for Nu and Sh

   Nu  = b1 * 0.66 *  Pr^0.33 * Re(p)^0.5;       % Nusselt number
   Shv = b1 * 0.66 * Scv^0.33 * Re(p)^0.5;       % Sherwood number, H2O
   Shc = b1 * 0.66 * Scc^0.33 * Re(p)^0.5;       % Sherwood number, CO2

   gbh1(p) = Dh * Nu / dleaf(p) * rhomol(p);     % Boundary layer conductance, heat (mol/m2/s)
   gbw1(p) = Dv * Shv / dleaf(p) * rhomol(p);    % Boundary layer conductance, H2O (mol/m2/s)
   gbc1(p) = Dc * Shc / dleaf(p) * rhomol(p);    % Boundary layer conductance, CO2 (mol/m2/s)

   % Forced convection - turbulent flow

   Nu  = b1 * 0.036 *  Pr^0.33 * Re(p)^0.8;      % Nusselt number
   Shv = b1 * 0.036 * Scv^0.33 * Re(p)^0.8;      % Sherwood number, H2O
   Shc = b1 * 0.036 * Scc^0.33 * Re(p)^0.8;      % Sherwood number, CO2

   gbh2(p) = Dh * Nu / dleaf(p) * rhomol(p);     % Boundary layer conductance, heat (mol/m2/s)
   gbw2(p) = Dv * Shv / dleaf(p) * rhomol(p);    % Boundary layer conductance, H2O (mol/m2/s)
   gbc2(p) = Dc * Shc / dleaf(p) * rhomol(p);    % Boundary layer conductance, CO2 (mol/m2/s)

   % Free convection

   Nu  = 0.54 *  Pr^0.25 * Gr^0.25;              % Nusselt number
   Shv = 0.54 * Scv^0.25 * Gr^0.25;              % Sherwood number, H2O
   Shc = 0.54 * Scc^0.25 * Gr^0.25;              % Sherwood number, CO2

   gbh3(p) = Dh * Nu / dleaf(p) * rhomol(p);     % Boundary layer conductance, heat (mol/m2/s)
   gbw3(p) = Dv * Shv / dleaf(p) * rhomol(p);    % Boundary layer conductance, H2O (mol/m2/s)
   gbc3(p) = Dc * Shc / dleaf(p) * rhomol(p);    % Boundary layer conductance, CO2 (mol/m2/s)

end

% Make graph

plot(wind,gbh1,'b-',wind,gbh2,'r-')
title('Heat')
xlabel('Wind speed (m s^{-1})')
ylabel('Boundary layer conductance (mol m^{-2} s^{-1})')
legend('Laminar','Turbulent','Location','best')

% Write output to files

A = [wind; Re; gbh1];
fileID = fopen('forced-laminar.dat','w');
fprintf(fileID,'%10s %10s %10s\n','wind','Re','gbh');
fprintf(fileID,'%10.1f %10.2f %10.4f\n', A);
fclose(fileID);

B = [wind; Re; gbh2];
fileID = fopen('forced-turbulent.dat','w');
fprintf(fileID,'%10s %10s %10s\n','wind','Re','gbh');
fprintf(fileID,'%10.1f %10.2f %10.4f\n', B);
fclose(fileID);

C = [tleaf-tair; gbh3];
fileID = fopen('free-convection.dat','w');
fprintf(fileID,'%10s %10s\n','Tl-Ta','gbh');
fprintf(fileID,'%10.1f %10.4f\n', C);
fclose(fileID);
```
{: #main-program-code}

</details>



# Output

## Figures

Figure 1

<img src="https://raw.githubusercontent.com/zmoon92/bonanmodeling/gh-pages-dev/sp_10_01/fig01.png">

## Text
<details>
  <summary markdown="span">
    `forced-laminar.dat`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_10_01/forced-laminar.dat)
    <span class="program-code-link-sep">|</span>
    [View raw](https://raw.githubusercontent.com/zmoon92/bonanmodeling/gh-pages-dev/sp_10_01/forced-laminar.dat)
  </summary>

```
wind         Re        gbh
       0.1     341.27     0.2868
       0.2     682.53     0.4056
       0.3    1023.80     0.4968
       0.4    1365.07     0.5736
       0.5    1706.34     0.6413
       0.6    2047.60     0.7025
       0.7    2388.87     0.7588
       0.8    2730.14     0.8112
       0.9    3071.41     0.8604
       1.0    3412.67     0.9070
       1.1    3753.94     0.9513
       1.2    4095.21     0.9936
       1.3    4436.48     1.0341
       1.4    4777.74     1.0732
       1.5    5119.01     1.1108
       1.6    5460.28     1.1473
       1.7    5801.55     1.1826
       1.8    6142.81     1.2168
       1.9    6484.08     1.2502
       2.0    6825.35     1.2827
       2.1    7166.62     1.3143
       2.2    7507.88     1.3453
       2.3    7849.15     1.3755
       2.4    8190.42     1.4051
       2.5    8531.69     1.4341
       2.6    8872.95     1.4625
       2.7    9214.22     1.4903
       2.8    9555.49     1.5177
       2.9    9896.76     1.5445
       3.0   10238.02     1.5709
       3.1   10579.29     1.5969
       3.2   10920.56     1.6225
       3.3   11261.83     1.6476
       3.4   11603.09     1.6724
       3.5   11944.36     1.6968
       3.6   12285.63     1.7209
       3.7   12626.89     1.7446
       3.8   12968.16     1.7680
       3.9   13309.43     1.7912
       4.0   13650.70     1.8140
       4.1   13991.96     1.8365
       4.2   14333.23     1.8588
       4.3   14674.50     1.8808
       4.4   15015.77     1.9025
       4.5   15357.03     1.9240
       4.6   15698.30     1.9453
       4.7   16039.57     1.9663
       4.8   16380.84     1.9871
       4.9   16722.10     2.0077
       5.0   17063.37     2.0281
       5.1   17404.64     2.0483
       5.2   17745.91     2.0682
       5.3   18087.17     2.0880
       5.4   18428.44     2.1076
       5.5   18769.71     2.1271
       5.6   19110.98     2.1463
       5.7   19452.24     2.1654
       5.8   19793.51     2.1843
       5.9   20134.78     2.2031
       6.0   20476.05     2.2216
       6.1   20817.31     2.2401
       6.2   21158.58     2.2584
       6.3   21499.85     2.2765
       6.4   21841.12     2.2945
       6.5   22182.38     2.3124
       6.6   22523.65     2.3301
       6.7   22864.92     2.3477
       6.8   23206.18     2.3651
       6.9   23547.45     2.3825
       7.0   23888.72     2.3997
       7.1   24229.99     2.4167
       7.2   24571.25     2.4337
       7.3   24912.52     2.4505
       7.4   25253.79     2.4673
       7.5   25595.06     2.4839
       7.6   25936.32     2.5004
       7.7   26277.59     2.5168
       7.8   26618.86     2.5331
       7.9   26960.13     2.5493
       8.0   27301.39     2.5653
       8.1   27642.66     2.5813
       8.2   27983.93     2.5972
       8.3   28325.20     2.6130
       8.4   28666.46     2.6287
       8.5   29007.73     2.6443
       8.6   29349.00     2.6598
       8.7   29690.27     2.6752
       8.8   30031.53     2.6906
       8.9   30372.80     2.7058
       9.0   30714.07     2.7210
       9.1   31055.34     2.7360
       9.2   31396.60     2.7510
       9.3   31737.87     2.7659
       9.4   32079.14     2.7808
       9.5   32420.41     2.7955
       9.6   32761.67     2.8102
       9.7   33102.94     2.8248
       9.8   33444.21     2.8393
       9.9   33785.48     2.8538
      10.0   34126.74     2.8681
```
{: .main-program-output-text-file}

</details>
<details>
  <summary markdown="span">
    `forced-turbulent.dat`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_10_01/forced-turbulent.dat)
    <span class="program-code-link-sep">|</span>
    [View raw](https://raw.githubusercontent.com/zmoon92/bonanmodeling/gh-pages-dev/sp_10_01/forced-turbulent.dat)
  </summary>

```
wind         Re        gbh
       0.1     341.27     0.0900
       0.2     682.53     0.1567
       0.3    1023.80     0.2168
       0.4    1365.07     0.2729
       0.5    1706.34     0.3262
       0.6    2047.60     0.3774
       0.7    2388.87     0.4269
       0.8    2730.14     0.4751
       0.9    3071.41     0.5220
       1.0    3412.67     0.5679
       1.1    3753.94     0.6129
       1.2    4095.21     0.6571
       1.3    4436.48     0.7006
       1.4    4777.74     0.7433
       1.5    5119.01     0.7855
       1.6    5460.28     0.8271
       1.7    5801.55     0.8683
       1.8    6142.81     0.9089
       1.9    6484.08     0.9491
       2.0    6825.35     0.9888
       2.1    7166.62     1.0282
       2.2    7507.88     1.0671
       2.3    7849.15     1.1058
       2.4    8190.42     1.1441
       2.5    8531.69     1.1821
       2.6    8872.95     1.2197
       2.7    9214.22     1.2571
       2.8    9555.49     1.2942
       2.9    9896.76     1.3311
       3.0   10238.02     1.3677
       3.1   10579.29     1.4040
       3.2   10920.56     1.4401
       3.3   11261.83     1.4760
       3.4   11603.09     1.5117
       3.5   11944.36     1.5472
       3.6   12285.63     1.5824
       3.7   12626.89     1.6175
       3.8   12968.16     1.6524
       3.9   13309.43     1.6871
       4.0   13650.70     1.7216
       4.1   13991.96     1.7560
       4.2   14333.23     1.7901
       4.3   14674.50     1.8242
       4.4   15015.77     1.8580
       4.5   15357.03     1.8917
       4.6   15698.30     1.9253
       4.7   16039.57     1.9587
       4.8   16380.84     1.9920
       4.9   16722.10     2.0251
       5.0   17063.37     2.0581
       5.1   17404.64     2.0909
       5.2   17745.91     2.1237
       5.3   18087.17     2.1563
       5.4   18428.44     2.1888
       5.5   18769.71     2.2211
       5.6   19110.98     2.2534
       5.7   19452.24     2.2855
       5.8   19793.51     2.3176
       5.9   20134.78     2.3495
       6.0   20476.05     2.3813
       6.1   20817.31     2.4130
       6.2   21158.58     2.4446
       6.3   21499.85     2.4761
       6.4   21841.12     2.5074
       6.5   22182.38     2.5387
       6.6   22523.65     2.5699
       6.7   22864.92     2.6010
       6.8   23206.18     2.6321
       6.9   23547.45     2.6630
       7.0   23888.72     2.6938
       7.1   24229.99     2.7245
       7.2   24571.25     2.7552
       7.3   24912.52     2.7858
       7.4   25253.79     2.8163
       7.5   25595.06     2.8467
       7.6   25936.32     2.8770
       7.7   26277.59     2.9072
       7.8   26618.86     2.9374
       7.9   26960.13     2.9675
       8.0   27301.39     2.9975
       8.1   27642.66     3.0274
       8.2   27983.93     3.0573
       8.3   28325.20     3.0871
       8.4   28666.46     3.1168
       8.5   29007.73     3.1465
       8.6   29349.00     3.1760
       8.7   29690.27     3.2055
       8.8   30031.53     3.2350
       8.9   30372.80     3.2644
       9.0   30714.07     3.2937
       9.1   31055.34     3.3229
       9.2   31396.60     3.3521
       9.3   31737.87     3.3812
       9.4   32079.14     3.4103
       9.5   32420.41     3.4393
       9.6   32761.67     3.4682
       9.7   33102.94     3.4971
       9.8   33444.21     3.5259
       9.9   33785.48     3.5546
      10.0   34126.74     3.5833
```
{: .main-program-output-text-file}

</details>
<details>
  <summary markdown="span">
    `free-convection.dat`
    <span class="program-code-link-sep">|</span>
    [View on GitHub {% octicon mark-github %}](https://github.com/zmoon92/bonanmodeling/tree/master/sp_10_01/free-convection.dat)
    <span class="program-code-link-sep">|</span>
    [View raw](https://raw.githubusercontent.com/zmoon92/bonanmodeling/gh-pages-dev/sp_10_01/free-convection.dat)
  </summary>

```
Tl-Ta        gbh
       0.1     0.0581
       0.2     0.0691
       0.3     0.0765
       0.4     0.0822
       0.5     0.0869
       0.6     0.0910
       0.7     0.0945
       0.8     0.0977
       0.9     0.1007
       1.0     0.1033
       1.1     0.1058
       1.2     0.1082
       1.3     0.1103
       1.4     0.1124
       1.5     0.1144
       1.6     0.1162
       1.7     0.1180
       1.8     0.1197
       1.9     0.1213
       2.0     0.1229
       2.1     0.1244
       2.2     0.1259
       2.3     0.1273
       2.4     0.1286
       2.5     0.1299
       2.6     0.1312
       2.7     0.1325
       2.8     0.1337
       2.9     0.1349
       3.0     0.1360
       3.1     0.1371
       3.2     0.1382
       3.3     0.1393
       3.4     0.1403
       3.5     0.1414
       3.6     0.1423
       3.7     0.1433
       3.8     0.1443
       3.9     0.1452
       4.0     0.1461
       4.1     0.1471
       4.2     0.1479
       4.3     0.1488
       4.4     0.1497
       4.5     0.1505
       4.6     0.1513
       4.7     0.1522
       4.8     0.1530
       4.9     0.1538
       5.0     0.1545
       5.1     0.1553
       5.2     0.1561
       5.3     0.1568
       5.4     0.1575
       5.5     0.1583
       5.6     0.1590
       5.7     0.1597
       5.8     0.1604
       5.9     0.1611
       6.0     0.1617
       6.1     0.1624
       6.2     0.1631
       6.3     0.1637
       6.4     0.1644
       6.5     0.1650
       6.6     0.1656
       6.7     0.1663
       6.8     0.1669
       6.9     0.1675
       7.0     0.1681
       7.1     0.1687
       7.2     0.1693
       7.3     0.1699
       7.4     0.1704
       7.5     0.1710
       7.6     0.1716
       7.7     0.1721
       7.8     0.1727
       7.9     0.1733
       8.0     0.1738
       8.1     0.1743
       8.2     0.1749
       8.3     0.1754
       8.4     0.1759
       8.5     0.1765
       8.6     0.1770
       8.7     0.1775
       8.8     0.1780
       8.9     0.1785
       9.0     0.1790
       9.1     0.1795
       9.2     0.1800
       9.3     0.1805
       9.4     0.1810
       9.5     0.1814
       9.6     0.1819
       9.7     0.1824
       9.8     0.1828
       9.9     0.1833
      10.0     0.1838
```
{: .main-program-output-text-file}

</details>